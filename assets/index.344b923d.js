import{w as Ie,S as F,i as T,s as U,e as le,a as j,b as h,t as V,c as u,d as D,f as L,g as Ve,h as k,j as _,k as W,l as oe,m as E,n as re,r as ae,o as ke,p as Be,q as ie,u as Oe,v as ce,x as O,y as ue,z as P,A as fe,B as de,C as pe,D as Se,E as K,F as ge,G as Y,H as x,I as Ce,J as ze,K as Ne,L as Q,M as me,N as Z,O as je}from"./vendor.25868053.js";const Le=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function s(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerpolicy&&(o.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?o.credentials="include":e.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(e){if(e.ep)return;e.ep=!0;const o=s(e);fetch(e.href,o)}};Le();function Me(l){l.slice(0,1)==="#"&&(l=l.slice(1));const t=parseInt(l.substr(0,2),16),s=parseInt(l.substr(2,2),16),n=parseInt(l.substr(4,2),16);return(t*299+s*587+n*114)/1e3>=128?"black":"white"}const H={red:"#ce0000",green:"#0f480c",yellow:"#dcd138",orange:"#ff7200",black:"#000000",pink:"#ff00ed",blue:"#0093ff",purple:"#822fe0",lime:"#05ff00",white:"#ffffff"};function Xe(l,t){let s=t.filter((e,o)=>{for(const a of e.climb_groups)if(a.climb_id==l)return e});return s.length<1?s="aaa":s=s[0].name,s=s.toLowerCase(),s.split("/").length>1&&(s=s.split("/")[0]),H[s]?H[s]:"#0000ff"}function qe(l,t){let s=t.filter((e,o)=>{for(const a of e.climb_groups)if(a.climb_id==l)return e});if(s.length<1?s="aaa":s=s[0].name,s=s.toLowerCase(),s.split("/").length>1){const e=s.split("/");return`--dot-col: linear-gradient(315deg, ${H[e[0]]} 50%, ${H[e[1]]} 50%)`}return`--dot-col: ${H[s]?H[s]:"#0000ff"}`}const Pe={uiaa:{2:"III",3:"IV-",3.44:"IV",3.89:"IV+",4.33:"V-",4.67:"V",4.92:"V+",5.5:"VI",5.21:"VI-",5.78:"VI+",6.06:"VII-",6.33:"VII",6.56:"VII+",6.78:"VIII-",7:"VIII",7.22:"VIII+",7.44:"IX-",7.67:"IX",7.89:"IX+",8.11:"X-",8.33:"X",8.56:"X+",8.78:"XI-",9:"XI",9.22:"XI+",9.44:"XII-"},yds:{2:"5.3",3:"5.4",4:"5.5",4.33:"5.6",4.67:"5.7",5:"5.8",5.33:"5.9",5.67:"5.10a",6:"5.10b",6.5:"5.11a",6.17:"5.10c",6.33:"5.10d",6.67:"5.11b",6.83:"5.11c",7:"5.11d",7.5:"5.12c",7.17:"5.12a",7.33:"5.12b",7.67:"5.12d",7.83:"5.13a",8:"5.13b",8.5:"5.14a",8.17:"5.13c",8.33:"5.13d",8.67:"5.14b",8.83:"5.14c",9:"5.14d",9.5:"5.15c",9.17:"5.15a",9.33:"5.15b"},french:{2:"2",2.5:"2",3:"3a",3.33:"3b",3.67:"3c",4:"4a",4.33:"4b",4.67:"4c",5:"5a",5.17:"5a+",5.33:"5b",5.5:"5b+",5.67:"5c",5.83:"5c+",6:"6a",6.17:"6a+",6.33:"6b",6.5:"6b+",6.67:"6c",6.83:"6c+",7:"7a",7.17:"7a+",7.33:"7b",7.5:"7b+",7.67:"7c",7.83:"7c+",8:"8a",8.17:"8a+",8.33:"8b",8.5:"8b+",8.67:"8c",8.83:"8c+",9:"9a",9.17:"9a+",9.33:"9b",9.5:"9b+"},french_boulder:{2:"2",2.5:"2",2.75:"2+",3:"3a",3.33:"3b",3.67:"3c",4:"4a",4.33:"4b",4.67:"4c",5:"5a",5.17:"5a+",5.33:"5b",5.5:"5b+",5.67:"5c",5.83:"5c+",6:"6a",6.17:"6a+",6.33:"6b",6.5:"6b+",6.67:"6c",6.83:"6c+",7:"7a",7.17:"7a+",7.33:"7b",7.5:"7b+",7.67:"7c",7.83:"7c+",8:"8a",8.17:"8a+",8.33:"8b",8.5:"8b+",8.67:"8c",8.83:"8c+",9:"9a",9.17:"9a+",9.33:"9b",9.5:"9b+"},french_rounded:{2:"2",2.5:"2",2.75:"2+",3:"3",3.33:"3+",3.67:"4-",4:"4",4.33:"4+",4.67:"5-",5:"5",5.5:"5+",6:"6a",6.5:"6b+",6.17:"6a+",6.33:"6b",6.67:"6c",6.83:"6c+",7:"7a",7.5:"7b+",7.17:"7a+",7.33:"7b",7.67:"7c",7.83:"7c+",8:"8a",8.5:"8b+",8.17:"8a+",8.33:"8b",8.67:"8c",8.83:"8c+",9:"9a",9.5:"9b+",9.17:"9a+",9.33:"9b"},ewbank:{2:"7",3:"8",3.33:"9",3.67:"10",4:"11",4.33:"12",4.66:"13",5:"14",5.33:"15",5.67:"16",6:"17",6.5:"20",6.17:"18",6.33:"19",6.67:"21",6.83:"22",7:"23",7.5:"26",7.17:"24",7.33:"25",7.67:"27",7.83:"28",8:"29",8.5:"32",8.17:"30",8.33:"31",8.67:"33",8.83:"34",9:"35",9.5:"38",9.17:"36",9.33:"37"},british:{2:"B0",3:"B1",3.83:"B2",5:"B3",6:"B4",6.28:"B5",6.56:"B6",6.83:"B7",7.11:"B8",7.39:"B9",7.67:"B10",7.87:"B11",8.08:"B12",8.29:"B13",8.5:"B14",8.67:"B15",8.83:"B16",9:"B17"},v_grade:{2:"VB",3:"VB",3.5:"V0-",4:"V0",4.5:"V0+",5:"V1",5.5:"V2",6:"V3",6.33:"V4",6.67:"V5",7:"V6",7.2:"V7",7.4:"V8",7.6:"V9",7.8:"V10",8:"V11",8.17:"V12",8.33:"V13",8.5:"V14",8.67:"V15",8.83:"V16",9:"V17"}};function ee(l,t){return Pe[t][Number(l)]}const Ae=JSON.parse(localStorage.getItem("gyms")),te=Ie(Ae);te.subscribe(l=>{typeof l=="object"&&l!=null&&localStorage.setItem("gyms",JSON.stringify(l))});function he(l,t,s){const n=l.slice();return n[5]=t[s],n}function _e(l){let t,s=l[1],n=[];for(let e=0;e<s.length;e+=1)n[e]=be(he(l,s,e));return{c(){for(let e=0;e<n.length;e+=1)n[e].c();t=le()},m(e,o){for(let a=0;a<n.length;a+=1)n[a].m(e,o);j(e,t,o)},p(e,o){if(o&2){s=e[1];let a;for(a=0;a<s.length;a+=1){const r=he(e,s,a);n[a]?n[a].p(r,o):(n[a]=be(r),n[a].c(),n[a].m(t.parentNode,t))}for(;a<n.length;a+=1)n[a].d(1);n.length=s.length}},d(e){Ve(n,e),e&&L(t)}}}function be(l){let t,s=l[5].name+"",n,e;return{c(){t=h("option"),n=V(s),t.__value=e=l[5],t.value=t.__value},m(o,a){j(o,t,a),u(t,n)},p(o,a){a&2&&s!==(s=o[5].name+"")&&D(n,s),a&2&&e!==(e=o[5])&&(t.__value=e,t.value=t.__value)},d(o){o&&L(t)}}}function He(l){let t,s,n,e,o,a,r=l[1]&&_e(l);return{c(){t=h("div"),s=h("label"),s.textContent="Gym",n=k(),e=h("select"),r&&r.c(),_(s,"for","gym"),_(e,"name",""),_(e,"id","gym"),l[0]===void 0&&W(()=>l[3].call(e)),_(t,"class","select svelte-1f5yysq")},m(i,m){j(i,t,m),u(t,s),u(t,n),u(t,e),r&&r.m(e,null),oe(e,l[0]),o||(a=[E(e,"change",l[3]),E(e,"change",l[4])],o=!0)},p(i,[m]){i[1]?r?r.p(i,m):(r=_e(i),r.c(),r.m(e,null)):r&&(r.d(1),r=null),m&3&&oe(e,i[0])},i:re,o:re,d(i){i&&L(t),r&&r.d(),o=!1,ae(a)}}}function Je(l,t,s){let n;ke(l,te,i=>s(1,n=i));let e;const o=Be();ie(async()=>{if(n==null){console.log("fetching gyms");const m=await(await fetch("https://api.toplogger.nu/v1/gyms/")).json();te.set(m)}});function a(){e=Oe(this),s(0,e)}return[e,n,o,a,()=>{o("change",e)}]}class Re extends F{constructor(t){super();T(this,t,Je,He,U,{})}}function ve(l){const t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],s=l?new Date(l):new Date,n=t[s.getMonth()],e=String(s.getDate()).padStart(2,"0"),o=s.getFullYear();return`${e} ${n} ${o}`}function ye(l){let t,s,n,e,o,a,r,i,m,f=ee(l[0].grade,"french_boulder")+"",c,b,I,S,p=l[0].nr_of_ascends+"",g,G,C,M,B=l[0].average_opinion+"",z,J,R,d,y,v=ve(l[0].date_set)+"",X,w,$,q,se;return{c(){t=h("div"),s=h("div"),n=h("h3"),n.textContent="Route data",e=k(),o=h("button"),o.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg>',a=k(),r=h("ul"),i=h("li"),m=V("grade: "),c=V(f),b=k(),I=h("li"),S=V("ascends: "),g=V(p),G=k(),C=h("li"),M=V("average opinion: "),z=V(B),J=V("/5.0"),R=k(),d=h("li"),y=V("date set: "),X=V(v),_(n,"class","svelte-r6e04p"),_(o,"class","svelte-r6e04p"),_(s,"class","preview__header svelte-r6e04p"),_(i,"class","svelte-r6e04p"),_(I,"class","svelte-r6e04p"),_(C,"class","svelte-r6e04p"),_(d,"class","svelte-r6e04p"),_(t,"class","preview svelte-r6e04p")},m(N,A){j(N,t,A),u(t,s),u(s,n),u(s,e),u(s,o),u(t,a),u(t,r),u(r,i),u(i,m),u(i,c),u(r,b),u(r,I),u(I,S),u(I,g),u(r,G),u(r,C),u(C,M),u(C,z),u(C,J),u(r,R),u(r,d),u(d,y),u(d,X),$=!0,q||(se=E(o,"click",l[1]),q=!0)},p(N,A){l=N,(!$||A&1)&&f!==(f=ee(l[0].grade,"french_boulder")+"")&&D(c,f),(!$||A&1)&&p!==(p=l[0].nr_of_ascends+"")&&D(g,p),(!$||A&1)&&B!==(B=l[0].average_opinion+"")&&D(z,B),(!$||A&1)&&v!==(v=ve(l[0].date_set)+"")&&D(X,v)},i(N){$||(W(()=>{w||(w=ce(t,pe,{duration:200,easing:de},!0)),w.run(1)}),$=!0)},o(N){w||(w=ce(t,pe,{duration:200,easing:de},!1)),w.run(0),$=!1},d(N){N&&L(t),N&&w&&w.end(),q=!1,se()}}}function De(l){let t,s,n=l[0]&&ye(l);return{c(){n&&n.c(),t=le()},m(e,o){n&&n.m(e,o),j(e,t,o),s=!0},p(e,[o]){e[0]?n?(n.p(e,o),o&1&&O(n,1)):(n=ye(e),n.c(),O(n,1),n.m(t.parentNode,t)):n&&(ue(),P(n,1,1,()=>{n=null}),fe())},i(e){s||(O(n),s=!0)},o(e){P(n),s=!1},d(e){n&&n.d(e),e&&L(t)}}}function Ee(l,t,s){let{data:n}=t;function e(o){Se.call(this,l,o)}return l.$$set=o=>{"data"in o&&s(0,n=o.data)},[n,e]}class Fe extends F{constructor(t){super();T(this,t,Ee,De,U,{data:0})}}function Te(l){let t,s,n,e,o,a,r,i,m,f;return r=new Re({}),r.$on("change",Ue),{c(){t=h("header"),s=h("label"),s.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>',n=k(),e=h("input"),o=k(),a=h("div"),K(r.$$.fragment),_(s,"for","menuToggle"),_(e,"type","checkbox"),_(e,"id","menuToggle"),_(e,"class","svelte-qwp3ms"),_(a,"class","menu svelte-qwp3ms"),ge(a,"open",l[0]),_(t,"class","svelte-qwp3ms")},m(c,b){j(c,t,b),u(t,s),u(t,n),u(t,e),e.checked=l[0],u(t,o),u(t,a),Y(r,a,null),i=!0,m||(f=E(e,"change",l[1]),m=!0)},p(c,[b]){b&1&&(e.checked=c[0]),b&1&&ge(a,"open",c[0])},i(c){i||(O(r.$$.fragment,c),i=!0)},o(c){P(r.$$.fragment,c),i=!1},d(c){c&&L(t),x(r),m=!1,f()}}}const Ue=async l=>{};function Ge(l,t,s){let n=!1;function e(){n=this.checked,s(0,n)}return[n,e]}class We extends F{constructor(t){super();T(this,t,Ge,Te,U,{})}}const{window:ne}=Ne;function we(l){let t,s;return t=new Fe({props:{data:l[4]}}),t.$on("click",l[6]),{c(){K(t.$$.fragment)},m(n,e){Y(t,n,e),s=!0},p(n,e){const o={};e&16&&(o.data=n[4]),t.$set(o)},i(n){s||(O(t.$$.fragment,n),s=!0)},o(n){P(t.$$.fragment,n),s=!1},d(n){x(t,n)}}}function Ke(l){let t,s,n,e,o,a,r,i,m;W(l[5]),t=new We({});let f=l[2]&&we(l);return{c(){K(t.$$.fragment),s=k(),n=h("main"),e=h("div"),a=k(),f&&f.c(),_(e,"class","svgContainer svelte-wdcirs")},m(c,b){Y(t,c,b),j(c,s,b),j(c,n,b),u(n,e),e.innerHTML=l[3],u(n,a),f&&f.m(n,null),r=!0,i||(m=[E(ne,"resize",l[5]),Ce(o=Ye.call(null,e,l[3]))],i=!0)},p(c,[b]){(!r||b&8)&&(e.innerHTML=c[3]),o&&ze(o.update)&&b&8&&o.update.call(null,c[3]),c[2]?f?(f.p(c,b),b&4&&O(f,1)):(f=we(c),f.c(),O(f,1),f.m(n,null)):f&&(ue(),P(f,1,1,()=>{f=null}),fe())},i(c){r||(O(t.$$.fragment,c),O(f),r=!0)},o(c){P(t.$$.fragment,c),P(f),r=!1},d(c){x(t,c),c&&L(s),c&&L(n),f&&f.d(),i=!1,ae(m)}}}const $e="https://api.toplogger.nu/v1";function Ye(l,t){return{update(){},destroy(){}}}function xe(l){return`https://cdn1.toplogger.nu/images/gyms/${l}/floorplan.svg`}function Qe(l){const t={filters:{deleted:!1,live:!0}};return`${$e}/gyms/${l}/climbs?json_params=${encodeURIComponent(JSON.stringify(t))}`}function Ze(l){const t={filters:{gym_id:l,deleted:!1,live:!0,score_system:"none"},includes:["climb_groups"]};return`${$e}/groups?json_params=${encodeURIComponent(JSON.stringify(t))}`}function et(l,t,s){let n=!1,e=[],o="",a,r=window.innerWidth,i=window.innerHeight;function m(){Q("svg.flex").attr("width",r).attr("height",i)}function f(I,S){const p=Q("svg.flex").attr("width",r).attr("height",i);me("g#zoom_layer").each(function(){let d=this;Q(d.parentNode).insert("g").attr("class","zoom").append(()=>d)});const g=p.select("#zoom_layer").node().getBBox();e=p.select("#zoom_layer").attr("transform",`translate(${-g.x}, ${-g.y})`).append("g").attr("class","routes").selectAll("g").data(I).enter().append("g").attr("transform",d=>`translate(${g.width*d.position_x}, ${g.height*d.position_y})`).attr("class","route").on("click",(d,y)=>{d.stopPropagation(),s(4,a=y),s(2,n=!0);const v=g.width/r*.75,X=g.width*y.position_x-g.x,w=g.height*y.position_y-g.y,$=r/2-2.5,q=i/2-2.5;p.transition().duration(500).call(B.transform,Z.translate(-X*v+$,-w*v+q).scale(v))}).append("foreignObject").attr("x",0).attr("y",0).attr("width",1).attr("height",1).attr("class","scale"),e.append("xhtml:div").html(d=>ee(d.grade,"french_boulder")).attr("style",d=>`${qe(d.id,S)}`).style("color",d=>Me(Xe(d.id,S)));const C=p.select(".zoom"),M=150,B=je().translateExtent([[-M,-M],[g.width+M,g.height+M]]).scaleExtent([.1,2.5]).on("zoom",(d,y)=>{C.attr("transform",d.transform),e.attr("transform",`scale(${1/d.transform.k})`)}),z=i/g.height*.9,J=r/2-g.width/2*z,R=i/2-g.height/2*z;p.call(B).call(B.transform,Z.translate(J,R).scale(z)),p.select(".zoom").attr("transform",`translate(${J}, ${R}) scale(${z})`),me("g.map-region").on("click",function(d){d.stopPropagation();const y=p.select(`#${this.id}`).node().getBBox(),v=i/y.height*.8,X=-(y.x-g.x)*v,w=-(y.y-g.y)*v,$=i/2-y.height/2*v,q=r/2-y.width/2*v;p.transition().duration(500).call(B.transform,Z.translate(X+q,w+$).scale(v))})}ie(async()=>{let I,S;s(3,[I,S,o]=await Promise.all([fetch(Qe(8)),fetch(Ze(8)),fetch(xe("bruut_boulder_breda"))]).then(p=>Promise.all([p[0].json(),p[1].json(),p[2].text()])).then(p=>(s(3,o=p[2]),p)).catch(p=>{throw new Error(p)}),o),f(I,S)});function c(){s(1,i=ne.innerHeight),s(0,r=ne.innerWidth)}const b=()=>{s(2,n=!1)};return l.$$.update=()=>{l.$$.dirty&1&&m(),l.$$.dirty&2&&m()},[r,i,n,o,a,c,b]}class tt extends F{constructor(t){super();T(this,t,et,Ke,U,{})}}new tt({target:document.body,props:{}});
