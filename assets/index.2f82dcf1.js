import{w as Oe,S as x,i as T,s as U,e as ae,a as j,b as _,t as O,c as f,d as J,f as G,g as Se,h as S,j as p,k as Y,l as re,m as P,n as ie,r as ce,o as ze,p as fe,q as ue,u as Ce,v as de,x as C,y as me,z as X,A as ge,B as pe,C as he,D as Ne,E as Q,F as _e,G as Z,H as ee,I as je,J as Ge,K as Me,L as te,M as be,N as ne,O as Le}from"./vendor.41c0da5c.js";const Xe=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))l(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&l(a)}).observe(document,{childList:!0,subtree:!0});function n(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerpolicy&&(s.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?s.credentials="include":e.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(e){if(e.ep)return;e.ep=!0;const s=n(e);fetch(e.href,s)}};Xe();const Ae=JSON.parse(localStorage.getItem("gyms")),le=Oe(Ae);le.subscribe(o=>{typeof o=="object"&&o!=null&&localStorage.setItem("gyms",JSON.stringify(o))});function De(o){o.slice(0,1)==="#"&&(o=o.slice(1));const t=parseInt(o.substr(0,2),16),n=parseInt(o.substr(2,2),16),l=parseInt(o.substr(4,2),16);return(t*299+n*587+l*114)/1e3>=128?"black":"white"}const E={red:"#ce0000",green:"#0f480c",yellow:"#dcd138",orange:"#ff7200",black:"#000000",pink:"#ff00ed",blue:"#0093ff",purple:"#822fe0",lime:"#05ff00",white:"#ffffff"};function Ee(o,t){let n=t.filter((e,s)=>{for(const a of e.climb_groups)if(a.climb_id==o)return e});return n.length<1?n="aaa":n=n[0].name,n=n.toLowerCase(),n.split("/").length>1&&(n=n.split("/")[0]),E[n]?E[n]:"#0000ff"}function Fe(o,t){let n=t.filter((e,s)=>{for(const a of e.climb_groups)if(a.climb_id==o)return e});if(n.length<1?n="aaa":n=n[0].name,n=n.toLowerCase(),n.split("/").length>1){const e=n.split("/");return`--dot-col: linear-gradient(315deg, ${E[e[0]]} 50%, ${E[e[1]]} 50%)`}return`--dot-col: ${E[n]?E[n]:"#0000ff"}`}const He={uiaa:{2:"III",3:"IV-",3.44:"IV",3.89:"IV+",4.33:"V-",4.67:"V",4.92:"V+",5.5:"VI",5.21:"VI-",5.78:"VI+",6.06:"VII-",6.33:"VII",6.56:"VII+",6.78:"VIII-",7:"VIII",7.22:"VIII+",7.44:"IX-",7.67:"IX",7.89:"IX+",8.11:"X-",8.33:"X",8.56:"X+",8.78:"XI-",9:"XI",9.22:"XI+",9.44:"XII-"},yds:{2:"5.3",3:"5.4",4:"5.5",4.33:"5.6",4.67:"5.7",5:"5.8",5.33:"5.9",5.67:"5.10a",6:"5.10b",6.5:"5.11a",6.17:"5.10c",6.33:"5.10d",6.67:"5.11b",6.83:"5.11c",7:"5.11d",7.5:"5.12c",7.17:"5.12a",7.33:"5.12b",7.67:"5.12d",7.83:"5.13a",8:"5.13b",8.5:"5.14a",8.17:"5.13c",8.33:"5.13d",8.67:"5.14b",8.83:"5.14c",9:"5.14d",9.5:"5.15c",9.17:"5.15a",9.33:"5.15b"},french:{2:"2",2.5:"2",3:"3a",3.33:"3b",3.67:"3c",4:"4a",4.33:"4b",4.67:"4c",5:"5a",5.17:"5a+",5.33:"5b",5.5:"5b+",5.67:"5c",5.83:"5c+",6:"6a",6.17:"6a+",6.33:"6b",6.5:"6b+",6.67:"6c",6.83:"6c+",7:"7a",7.17:"7a+",7.33:"7b",7.5:"7b+",7.67:"7c",7.83:"7c+",8:"8a",8.17:"8a+",8.33:"8b",8.5:"8b+",8.67:"8c",8.83:"8c+",9:"9a",9.17:"9a+",9.33:"9b",9.5:"9b+"},french_boulder:{2:"2",2.5:"2",2.75:"2+",3:"3a",3.33:"3b",3.67:"3c",4:"4a",4.33:"4b",4.67:"4c",5:"5a",5.17:"5a+",5.33:"5b",5.5:"5b+",5.67:"5c",5.83:"5c+",6:"6a",6.17:"6a+",6.33:"6b",6.5:"6b+",6.67:"6c",6.83:"6c+",7:"7a",7.17:"7a+",7.33:"7b",7.5:"7b+",7.67:"7c",7.83:"7c+",8:"8a",8.17:"8a+",8.33:"8b",8.5:"8b+",8.67:"8c",8.83:"8c+",9:"9a",9.17:"9a+",9.33:"9b",9.5:"9b+"},french_rounded:{2:"2",2.5:"2",2.75:"2+",3:"3",3.33:"3+",3.67:"4-",4:"4",4.33:"4+",4.67:"5-",5:"5",5.5:"5+",6:"6a",6.5:"6b+",6.17:"6a+",6.33:"6b",6.67:"6c",6.83:"6c+",7:"7a",7.5:"7b+",7.17:"7a+",7.33:"7b",7.67:"7c",7.83:"7c+",8:"8a",8.5:"8b+",8.17:"8a+",8.33:"8b",8.67:"8c",8.83:"8c+",9:"9a",9.5:"9b+",9.17:"9a+",9.33:"9b"},ewbank:{2:"7",3:"8",3.33:"9",3.67:"10",4:"11",4.33:"12",4.66:"13",5:"14",5.33:"15",5.67:"16",6:"17",6.5:"20",6.17:"18",6.33:"19",6.67:"21",6.83:"22",7:"23",7.5:"26",7.17:"24",7.33:"25",7.67:"27",7.83:"28",8:"29",8.5:"32",8.17:"30",8.33:"31",8.67:"33",8.83:"34",9:"35",9.5:"38",9.17:"36",9.33:"37"},british:{2:"B0",3:"B1",3.83:"B2",5:"B3",6:"B4",6.28:"B5",6.56:"B6",6.83:"B7",7.11:"B8",7.39:"B9",7.67:"B10",7.87:"B11",8.08:"B12",8.29:"B13",8.5:"B14",8.67:"B15",8.83:"B16",9:"B17"},v_grade:{2:"VB",3:"VB",3.5:"V0-",4:"V0",4.5:"V0+",5:"V1",5.5:"V2",6:"V3",6.33:"V4",6.67:"V5",7:"V6",7.2:"V7",7.4:"V8",7.6:"V9",7.8:"V10",8:"V11",8.17:"V12",8.33:"V13",8.5:"V14",8.67:"V15",8.83:"V16",9:"V17"}};function oe(o,t){return He[t][Number(o)]}const ye="https://api.toplogger.nu/v1";function Je(o){return`https://cdn1.toplogger.nu/images/gyms/${o}/floorplan.svg`}function Pe(o){const t={filters:{deleted:!1,live:!0}};return`${ye}/gyms/${o}/climbs?json_params=${encodeURIComponent(JSON.stringify(t))}`}function qe(o){const t={filters:{gym_id:o,deleted:!1,live:!0,score_system:"none"},includes:["climb_groups"]};return`${ye}/groups?json_params=${encodeURIComponent(JSON.stringify(t))}`}async function we(o,t){const[n,l,e]=await Promise.all([fetch(Pe(o)),fetch(qe(o)),fetch(Je(t))]).then(s=>Promise.all([s[0].json(),s[1].json(),s[2].text()])).then(s=>s).catch(s=>{throw new Error(s)});return[n,l,e]}function ve(o,t,n){const l=o.slice();return l[5]=t[n],l}function Ie(o){let t,n=o[1],l=[];for(let e=0;e<n.length;e+=1)l[e]=Ve(ve(o,n,e));return{c(){for(let e=0;e<l.length;e+=1)l[e].c();t=ae()},m(e,s){for(let a=0;a<l.length;a+=1)l[a].m(e,s);j(e,t,s)},p(e,s){if(s&2){n=e[1];let a;for(a=0;a<n.length;a+=1){const r=ve(e,n,a);l[a]?l[a].p(r,s):(l[a]=Ve(r),l[a].c(),l[a].m(t.parentNode,t))}for(;a<l.length;a+=1)l[a].d(1);l.length=n.length}},d(e){Se(l,e),e&&G(t)}}}function Ve(o){let t,n=o[5].name+"",l,e;return{c(){t=_("option"),l=O(n),t.__value=e=o[5],t.value=t.__value},m(s,a){j(s,t,a),f(t,l)},p(s,a){a&2&&n!==(n=s[5].name+"")&&J(l,n),a&2&&e!==(e=s[5])&&(t.__value=e,t.value=t.__value)},d(s){s&&G(t)}}}function Re(o){let t,n,l,e,s,a,r=o[1]&&Ie(o);return{c(){t=_("div"),n=_("label"),n.textContent="Gym",l=S(),e=_("select"),r&&r.c(),p(n,"for","gym"),p(e,"name",""),p(e,"id","gym"),o[0]===void 0&&Y(()=>o[3].call(e)),p(t,"class","p-4")},m(c,g){j(c,t,g),f(t,n),f(t,l),f(t,e),r&&r.m(e,null),re(e,o[0]),s||(a=[P(e,"change",o[3]),P(e,"change",o[4])],s=!0)},p(c,[g]){c[1]?r?r.p(c,g):(r=Ie(c),r.c(),r.m(e,null)):r&&(r.d(1),r=null),g&3&&re(e,c[0])},i:ie,o:ie,d(c){c&&G(t),r&&r.d(),s=!1,ce(a)}}}function xe(o,t,n){let l;ze(o,le,c=>n(1,l=c));let e;const s=fe();ue(async()=>{if(l==null){console.log("fetching gyms");const g=await(await fetch("https://api.toplogger.nu/v1/gyms/")).json();le.set(g)}});function a(){e=Ce(this),n(0,e)}return[e,l,s,a,()=>{s("change",e)}]}class Te extends x{constructor(t){super();T(this,t,xe,Re,U,{})}}function ke(o){const t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=o?new Date(o):new Date,l=t[n.getMonth()],e=String(n.getDate()).padStart(2,"0"),s=n.getFullYear();return`${e} ${l} ${s}`}function Be(o){let t,n,l,e,s,a,r,c,g,u=oe(o[0].grade,"french_boulder")+"",i,m,M,F,A=o[0].nr_of_ascends+"",H,q,N,k,I=o[0].average_opinion+"",y,h,R,B,L,z=ke(o[0].date_set)+"",D,V,d,b,w;return{c(){t=_("div"),n=_("div"),l=_("h3"),l.textContent="Route data",e=S(),s=_("button"),s.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg>',a=S(),r=_("ul"),c=_("li"),g=O("grade: "),i=O(u),m=S(),M=_("li"),F=O("ascends: "),H=O(A),q=S(),N=_("li"),k=O("average opinion: "),y=O(I),h=O("/5.0"),R=S(),B=_("li"),L=O("date set: "),D=O(z),p(l,"class","mr-auto"),p(s,"class","bg-none border-none leading-none"),p(n,"class","flex flex-row items-center mb-4"),p(c,"class","list-none"),p(M,"class","list-none"),p(N,"class","list-none"),p(B,"class","list-none"),p(t,"class","preview fixed bottom-0 left-0 w-screen px-4 py-4 bg-white shadow-lg md:w-max md:right-4 md:left-auto md:bottom-4")},m(v,$){j(v,t,$),f(t,n),f(n,l),f(n,e),f(n,s),f(t,a),f(t,r),f(r,c),f(c,g),f(c,i),f(r,m),f(r,M),f(M,F),f(M,H),f(r,q),f(r,N),f(N,k),f(N,y),f(N,h),f(r,R),f(r,B),f(B,L),f(B,D),d=!0,b||(w=P(s,"click",o[1]),b=!0)},p(v,$){o=v,(!d||$&1)&&u!==(u=oe(o[0].grade,"french_boulder")+"")&&J(i,u),(!d||$&1)&&A!==(A=o[0].nr_of_ascends+"")&&J(H,A),(!d||$&1)&&I!==(I=o[0].average_opinion+"")&&J(y,I),(!d||$&1)&&z!==(z=ke(o[0].date_set)+"")&&J(D,z)},i(v){d||(Y(()=>{V||(V=de(t,he,{duration:200,easing:pe},!0)),V.run(1)}),d=!0)},o(v){V||(V=de(t,he,{duration:200,easing:pe},!1)),V.run(0),d=!1},d(v){v&&G(t),v&&V&&V.end(),b=!1,w()}}}function Ue(o){let t,n,l=o[0]&&Be(o);return{c(){l&&l.c(),t=ae()},m(e,s){l&&l.m(e,s),j(e,t,s),n=!0},p(e,[s]){e[0]?l?(l.p(e,s),s&1&&C(l,1)):(l=Be(e),l.c(),C(l,1),l.m(t.parentNode,t)):l&&(me(),X(l,1,1,()=>{l=null}),ge())},i(e){n||(C(l),n=!0)},o(e){X(l),n=!1},d(e){l&&l.d(e),e&&G(t)}}}function We(o,t,n){let{data:l}=t;function e(s){Ne.call(this,o,s)}return o.$$set=s=>{"data"in s&&n(0,l=s.data)},[l,e]}class Ke extends x{constructor(t){super();T(this,t,We,Ue,U,{data:0})}}function Ye(o){let t,n,l,e,s,a,r,c,g,u;return r=new Te({}),r.$on("change",o[4]),{c(){t=_("header"),n=_("label"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>',l=S(),e=_("input"),s=S(),a=_("div"),Q(r.$$.fragment),p(n,"for","menuToggle"),p(n,"class","z-20"),p(e,"type","checkbox"),p(e,"id","menuToggle"),p(e,"class","w-0 h-0 hidden"),p(a,"class","menu fixed top-0 left-0 h-screen w-80 pt-12 bg-white shadow-lg svelte-3241ld"),_e(a,"open",o[1]),p(t,"class","fixed top-0 left-0 z-30 flex items-center px-4 py-2 bg-white shadow-lg svelte-3241ld")},m(i,m){j(i,t,m),f(t,n),f(t,l),f(t,e),e.checked=o[1],f(t,s),f(t,a),Z(r,a,null),c=!0,g||(u=P(e,"change",o[3]),g=!0)},p(i,[m]){m&2&&(e.checked=i[1]),m&2&&_e(a,"open",i[1])},i(i){c||(C(r.$$.fragment,i),c=!0)},o(i){X(r.$$.fragment,i),c=!1},d(i){i&&G(t),ee(r),g=!1,u()}}}function Qe(o,t,n){const l=fe();let e=!1,{selectedGym:s}=t;function a(){e=this.checked,n(1,e)}const r=c=>{n(0,s=c.detail),l("changeGym",c.detail)};return o.$$set=c=>{"selectedGym"in c&&n(0,s=c.selectedGym)},[s,e,l,a,r]}class Ze extends x{constructor(t){super();T(this,t,Qe,Ye,U,{selectedGym:0})}}const{window:se}=Me;function $e(o){let t,n;return t=new Ke({props:{data:o[6]}}),t.$on("click",o[11]),{c(){Q(t.$$.fragment)},m(l,e){Z(t,l,e),n=!0},p(l,e){const s={};e&64&&(s.data=l[6]),t.$set(s)},i(l){n||(C(t.$$.fragment,l),n=!0)},o(l){X(t.$$.fragment,l),n=!1},d(l){ee(t,l)}}}function et(o){let t,n,l,e,s,a,r,c,g;Y(o[9]),t=new Ze({}),t.$on("changeGym",o[10]);let u=o[2]&&$e(o);return{c(){Q(t.$$.fragment),n=S(),l=_("main"),e=_("div"),a=S(),u&&u.c(),p(e,"class","svgContainer h-screen svelte-1uvat6c")},m(i,m){Z(t,i,m),j(i,n,m),j(i,l,m),f(l,e),e.innerHTML=o[4],f(l,a),u&&u.m(l,null),r=!0,c||(g=[P(se,"resize",o[9]),je(s=o[8].call(null,e,o[4]))],c=!0)},p(i,[m]){(!r||m&16)&&(e.innerHTML=i[4]),s&&Ge(s.update)&&m&16&&s.update.call(null,i[4]),i[2]?u?(u.p(i,m),m&4&&C(u,1)):(u=$e(i),u.c(),C(u,1),u.m(l,null)):u&&(me(),X(u,1,1,()=>{u=null}),ge())},i(i){r||(C(t.$$.fragment,i),C(u),r=!0)},o(i){X(t.$$.fragment,i),X(u),r=!1},d(i){ee(t,i),i&&G(n),i&&G(l),u&&u.d(),c=!1,ce(g)}}}function tt(o,t,n){let l=!1,e=[],s="",a,r,c=1,g,u={},i=window.innerWidth,m=window.innerHeight;function M(k,I){return{update(){A(e,a)},destroy(){}}}function F(){te("svg.flex").attr("width",i).attr("height",m)}function A(k,I){const y=te("svg.flex").attr("width",i).attr("height",m);be("g#zoom_layer").each(function(){let d=this;te(d.parentNode).insert("g").attr("class","zoom").append(()=>d)});const h=y.select("#zoom_layer").node().getBBox();g=y.select("#zoom_layer").attr("transform",`translate(${-h.x}, ${-h.y})`).append("g").attr("class","routes"),n(3,e=g.selectAll("g").data(k).enter().append("g").attr("transform",d=>`translate(${h.width*d.position_x}, ${h.height*d.position_y})`).on("click",(d,b)=>{d.stopPropagation(),n(6,r=b),n(2,l=!0);const w=h.width/i*.75,v=h.width*b.position_x-h.x,$=h.height*b.position_y-h.y,W=i/2-2.5,K=m/2-2.5;y.transition().duration(500).call(L.transform,ne.translate(-v*w+W,-$*w+K).scale(w))}).append("foreignObject").attr("x",0).attr("y",0).attr("width",40).attr("height",40)),e.append("xhtml:div").html(d=>oe(d.grade,"french_boulder")).attr("style",d=>Fe(d.id,I)).style("color",d=>De(Ee(d.id,I)));const R=y.select(".zoom"),B=150,L=Le().translateExtent([[-B,-B],[h.width+B,h.height+B]]).scaleExtent([.1,2.5]).on("zoom",(d,b)=>{R.attr("transform",d.transform),c=Math.round(1/d.transform.k*100)/100}),z=m/h.height*.9,D=i/2-h.width/2*z,V=m/2-h.height/2*z;y.call(L).call(L.transform,ne.translate(D,V).scale(z)),y.select(".zoom").attr("transform",`translate(${D}, ${V}) scale(${z})`),be("g.map-region").on("click",function(d){d.stopPropagation();const b=y.select(`#${this.id}`).node().getBBox(),w=m/b.height*.8,v=-(b.x-h.x)*w,$=-(b.y-h.y)*w,W=m/2-b.height/2*w,K=i/2-b.width/2*w;y.transition().duration(500).call(L.transform,ne.translate(v+K,$+W).scale(w))})}ue(async()=>{n(3,[e,a,s]=await we(8,"bruut_boulder_breda"),e,n(5,a),n(4,s));let k;function I(){k=requestAnimationFrame(I),g&&g.attr("style",`--dot-scale: ${c}`)}return I(),()=>cancelAnimationFrame(k)});function H(){n(1,m=se.innerHeight),n(0,i=se.innerWidth)}const q=async k=>{n(7,u=k.detail),n(3,[e,a,s]=await we(u.id,u.id_name),e,n(5,a),n(4,s)),console.log(e,a)},N=()=>{n(2,l=!1)};return o.$$.update=()=>{o.$$.dirty&1&&F(),o.$$.dirty&2&&F()},[i,m,l,e,s,a,r,u,M,H,q,N]}class nt extends x{constructor(t){super();T(this,t,tt,et,U,{})}}new nt({target:document.body,props:{}});
