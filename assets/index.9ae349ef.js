import{w as Se,S as T,i as U,s as W,e as ae,a as N,b as h,t as S,c as u,d as F,f as j,g as Oe,h as O,j as _,k as x,l as re,m as H,n as ie,r as ce,o as ze,p as ue,q as fe,u as Ce,v as de,x as C,y as ge,z as X,A as me,B as pe,C as he,D as Ge,E as Q,F as _e,G as Z,H as ee,I as Ne,J as je,K as Me,L as te,M as be,N as ne,O as Le}from"./vendor.41c0da5c.js";const Xe=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerpolicy&&(o.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?o.credentials="include":e.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(e){if(e.ep)return;e.ep=!0;const o=n(e);fetch(e.href,o)}};Xe();const Ae=JSON.parse(localStorage.getItem("gyms")),se=Se(Ae);se.subscribe(l=>{typeof l=="object"&&l!=null&&localStorage.setItem("gyms",JSON.stringify(l))});function Pe(l){l.slice(0,1)==="#"&&(l=l.slice(1));const t=parseInt(l.substr(0,2),16),n=parseInt(l.substr(2,2),16),s=parseInt(l.substr(4,2),16);return(t*299+n*587+s*114)/1e3>=128?"black":"white"}const q={red:"#ce0000",green:"#0f480c",yellow:"#dcd138",orange:"#ff7200",black:"#000000",pink:"#ff00ed",blue:"#0093ff",purple:"#822fe0",lime:"#05ff00",white:"#ffffff"};function qe(l,t){let n=t.filter((e,o)=>{for(const a of e.climb_groups)if(a.climb_id==l)return e});return n.length<1?n="aaa":n=n[0].name,n=n.toLowerCase(),n.split("/").length>1&&(n=n.split("/")[0]),q[n]?q[n]:"#0000ff"}function De(l,t){let n=t.filter((e,o)=>{for(const a of e.climb_groups)if(a.climb_id==l)return e});if(n.length<1?n="aaa":n=n[0].name,n=n.toLowerCase(),n.split("/").length>1){const e=n.split("/");return`--dot-col: linear-gradient(315deg, ${q[e[0]]} 50%, ${q[e[1]]} 50%)`}return`--dot-col: ${q[n]?q[n]:"#0000ff"}`}const Ee={uiaa:{2:"III",3:"IV-",3.44:"IV",3.89:"IV+",4.33:"V-",4.67:"V",4.92:"V+",5.5:"VI",5.21:"VI-",5.78:"VI+",6.06:"VII-",6.33:"VII",6.56:"VII+",6.78:"VIII-",7:"VIII",7.22:"VIII+",7.44:"IX-",7.67:"IX",7.89:"IX+",8.11:"X-",8.33:"X",8.56:"X+",8.78:"XI-",9:"XI",9.22:"XI+",9.44:"XII-"},yds:{2:"5.3",3:"5.4",4:"5.5",4.33:"5.6",4.67:"5.7",5:"5.8",5.33:"5.9",5.67:"5.10a",6:"5.10b",6.5:"5.11a",6.17:"5.10c",6.33:"5.10d",6.67:"5.11b",6.83:"5.11c",7:"5.11d",7.5:"5.12c",7.17:"5.12a",7.33:"5.12b",7.67:"5.12d",7.83:"5.13a",8:"5.13b",8.5:"5.14a",8.17:"5.13c",8.33:"5.13d",8.67:"5.14b",8.83:"5.14c",9:"5.14d",9.5:"5.15c",9.17:"5.15a",9.33:"5.15b"},french:{2:"2",2.5:"2",3:"3a",3.33:"3b",3.67:"3c",4:"4a",4.33:"4b",4.67:"4c",5:"5a",5.17:"5a+",5.33:"5b",5.5:"5b+",5.67:"5c",5.83:"5c+",6:"6a",6.17:"6a+",6.33:"6b",6.5:"6b+",6.67:"6c",6.83:"6c+",7:"7a",7.17:"7a+",7.33:"7b",7.5:"7b+",7.67:"7c",7.83:"7c+",8:"8a",8.17:"8a+",8.33:"8b",8.5:"8b+",8.67:"8c",8.83:"8c+",9:"9a",9.17:"9a+",9.33:"9b",9.5:"9b+"},french_boulder:{2:"2",2.5:"2",2.75:"2+",3:"3a",3.33:"3b",3.67:"3c",4:"4a",4.33:"4b",4.67:"4c",5:"5a",5.17:"5a+",5.33:"5b",5.5:"5b+",5.67:"5c",5.83:"5c+",6:"6a",6.17:"6a+",6.33:"6b",6.5:"6b+",6.67:"6c",6.83:"6c+",7:"7a",7.17:"7a+",7.33:"7b",7.5:"7b+",7.67:"7c",7.83:"7c+",8:"8a",8.17:"8a+",8.33:"8b",8.5:"8b+",8.67:"8c",8.83:"8c+",9:"9a",9.17:"9a+",9.33:"9b",9.5:"9b+"},french_rounded:{2:"2",2.5:"2",2.75:"2+",3:"3",3.33:"3+",3.67:"4-",4:"4",4.33:"4+",4.67:"5-",5:"5",5.5:"5+",6:"6a",6.5:"6b+",6.17:"6a+",6.33:"6b",6.67:"6c",6.83:"6c+",7:"7a",7.5:"7b+",7.17:"7a+",7.33:"7b",7.67:"7c",7.83:"7c+",8:"8a",8.5:"8b+",8.17:"8a+",8.33:"8b",8.67:"8c",8.83:"8c+",9:"9a",9.5:"9b+",9.17:"9a+",9.33:"9b"},ewbank:{2:"7",3:"8",3.33:"9",3.67:"10",4:"11",4.33:"12",4.66:"13",5:"14",5.33:"15",5.67:"16",6:"17",6.5:"20",6.17:"18",6.33:"19",6.67:"21",6.83:"22",7:"23",7.5:"26",7.17:"24",7.33:"25",7.67:"27",7.83:"28",8:"29",8.5:"32",8.17:"30",8.33:"31",8.67:"33",8.83:"34",9:"35",9.5:"38",9.17:"36",9.33:"37"},british:{2:"B0",3:"B1",3.83:"B2",5:"B3",6:"B4",6.28:"B5",6.56:"B6",6.83:"B7",7.11:"B8",7.39:"B9",7.67:"B10",7.87:"B11",8.08:"B12",8.29:"B13",8.5:"B14",8.67:"B15",8.83:"B16",9:"B17"},v_grade:{2:"VB",3:"VB",3.5:"V0-",4:"V0",4.5:"V0+",5:"V1",5.5:"V2",6:"V3",6.33:"V4",6.67:"V5",7:"V6",7.2:"V7",7.4:"V8",7.6:"V9",7.8:"V10",8:"V11",8.17:"V12",8.33:"V13",8.5:"V14",8.67:"V15",8.83:"V16",9:"V17"}};function le(l,t){return Ee[t][Number(l)]}const ye="https://api.toplogger.nu/v1";function Fe(l){return`https://cdn1.toplogger.nu/images/gyms/${l}/floorplan.svg`}function He(l){const t={filters:{deleted:!1,live:!0}};return`${ye}/gyms/${l}/climbs?json_params=${encodeURIComponent(JSON.stringify(t))}`}function Je(l){const t={filters:{gym_id:l,deleted:!1,live:!0,score_system:"none"},includes:["climb_groups"]};return`${ye}/groups?json_params=${encodeURIComponent(JSON.stringify(t))}`}async function ve(l,t){const[n,s,e]=await Promise.all([fetch(He(l)),fetch(Je(l)),fetch(Fe(t))]).then(o=>Promise.all([o[0].json(),o[1].json(),o[2].text()])).then(o=>o).catch(o=>{throw new Error(o)});return[n,s,e]}function we(l,t,n){const s=l.slice();return s[5]=t[n],s}function Ie(l){let t,n=l[1],s=[];for(let e=0;e<n.length;e+=1)s[e]=Ve(we(l,n,e));return{c(){for(let e=0;e<s.length;e+=1)s[e].c();t=ae()},m(e,o){for(let a=0;a<s.length;a+=1)s[a].m(e,o);N(e,t,o)},p(e,o){if(o&2){n=e[1];let a;for(a=0;a<n.length;a+=1){const r=we(e,n,a);s[a]?s[a].p(r,o):(s[a]=Ve(r),s[a].c(),s[a].m(t.parentNode,t))}for(;a<s.length;a+=1)s[a].d(1);s.length=n.length}},d(e){Oe(s,e),e&&j(t)}}}function Ve(l){let t,n=l[5].name+"",s,e;return{c(){t=h("option"),s=S(n),t.__value=e=l[5],t.value=t.__value},m(o,a){N(o,t,a),u(t,s)},p(o,a){a&2&&n!==(n=o[5].name+"")&&F(s,n),a&2&&e!==(e=o[5])&&(t.__value=e,t.value=t.__value)},d(o){o&&j(t)}}}function Re(l){let t,n,s,e,o,a,r=l[1]&&Ie(l);return{c(){t=h("div"),n=h("label"),n.textContent="Gym",s=O(),e=h("select"),r&&r.c(),_(n,"for","gym"),_(e,"name",""),_(e,"id","gym"),l[0]===void 0&&x(()=>l[3].call(e)),_(t,"class","select svelte-1f5yysq")},m(c,m){N(c,t,m),u(t,n),u(t,s),u(t,e),r&&r.m(e,null),re(e,l[0]),o||(a=[H(e,"change",l[3]),H(e,"change",l[4])],o=!0)},p(c,[m]){c[1]?r?r.p(c,m):(r=Ie(c),r.c(),r.m(e,null)):r&&(r.d(1),r=null),m&3&&re(e,c[0])},i:ie,o:ie,d(c){c&&j(t),r&&r.d(),o=!1,ce(a)}}}function Te(l,t,n){let s;ze(l,se,c=>n(1,s=c));let e;const o=ue();fe(async()=>{if(s==null){console.log("fetching gyms");const m=await(await fetch("https://api.toplogger.nu/v1/gyms/")).json();se.set(m)}});function a(){e=Ce(this),n(0,e)}return[e,s,o,a,()=>{o("change",e)}]}class Ue extends T{constructor(t){super();U(this,t,Te,Re,W,{})}}function ke(l){const t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=l?new Date(l):new Date,s=t[n.getMonth()],e=String(n.getDate()).padStart(2,"0"),o=n.getFullYear();return`${e} ${s} ${o}`}function Be(l){let t,n,s,e,o,a,r,c,m,f=le(l[0].grade,"french_boulder")+"",i,g,M,D,A=l[0].nr_of_ascends+"",E,J,G,k,I=l[0].average_opinion+"",y,p,R,B,L,z=ke(l[0].date_set)+"",P,V,d,b,v;return{c(){t=h("div"),n=h("div"),s=h("h3"),s.textContent="Route data",e=O(),o=h("button"),o.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg>',a=O(),r=h("ul"),c=h("li"),m=S("grade: "),i=S(f),g=O(),M=h("li"),D=S("ascends: "),E=S(A),J=O(),G=h("li"),k=S("average opinion: "),y=S(I),p=S("/5.0"),R=O(),B=h("li"),L=S("date set: "),P=S(z),_(s,"class","svelte-1uei8sl"),_(o,"class","svelte-1uei8sl"),_(n,"class","preview__header svelte-1uei8sl"),_(c,"class","svelte-1uei8sl"),_(M,"class","svelte-1uei8sl"),_(G,"class","svelte-1uei8sl"),_(B,"class","svelte-1uei8sl"),_(t,"class","preview svelte-1uei8sl")},m(w,$){N(w,t,$),u(t,n),u(n,s),u(n,e),u(n,o),u(t,a),u(t,r),u(r,c),u(c,m),u(c,i),u(r,g),u(r,M),u(M,D),u(M,E),u(r,J),u(r,G),u(G,k),u(G,y),u(G,p),u(r,R),u(r,B),u(B,L),u(B,P),d=!0,b||(v=H(o,"click",l[1]),b=!0)},p(w,$){l=w,(!d||$&1)&&f!==(f=le(l[0].grade,"french_boulder")+"")&&F(i,f),(!d||$&1)&&A!==(A=l[0].nr_of_ascends+"")&&F(E,A),(!d||$&1)&&I!==(I=l[0].average_opinion+"")&&F(y,I),(!d||$&1)&&z!==(z=ke(l[0].date_set)+"")&&F(P,z)},i(w){d||(x(()=>{V||(V=de(t,he,{duration:200,easing:pe},!0)),V.run(1)}),d=!0)},o(w){V||(V=de(t,he,{duration:200,easing:pe},!1)),V.run(0),d=!1},d(w){w&&j(t),w&&V&&V.end(),b=!1,v()}}}function We(l){let t,n,s=l[0]&&Be(l);return{c(){s&&s.c(),t=ae()},m(e,o){s&&s.m(e,o),N(e,t,o),n=!0},p(e,[o]){e[0]?s?(s.p(e,o),o&1&&C(s,1)):(s=Be(e),s.c(),C(s,1),s.m(t.parentNode,t)):s&&(ge(),X(s,1,1,()=>{s=null}),me())},i(e){n||(C(s),n=!0)},o(e){X(s),n=!1},d(e){s&&s.d(e),e&&j(t)}}}function Ke(l,t,n){let{data:s}=t;function e(o){Ge.call(this,l,o)}return l.$$set=o=>{"data"in o&&n(0,s=o.data)},[s,e]}class Ye extends T{constructor(t){super();U(this,t,Ke,We,W,{data:0})}}function xe(l){let t,n,s,e,o,a,r,c,m,f;return r=new Ue({}),r.$on("change",l[4]),{c(){t=h("header"),n=h("label"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>',s=O(),e=h("input"),o=O(),a=h("div"),Q(r.$$.fragment),_(n,"for","menuToggle"),_(e,"type","checkbox"),_(e,"id","menuToggle"),_(e,"class","svelte-zlos4x"),_(a,"class","menu svelte-zlos4x"),_e(a,"open",l[1]),_(t,"class","svelte-zlos4x")},m(i,g){N(i,t,g),u(t,n),u(t,s),u(t,e),e.checked=l[1],u(t,o),u(t,a),Z(r,a,null),c=!0,m||(f=H(e,"change",l[3]),m=!0)},p(i,[g]){g&2&&(e.checked=i[1]),g&2&&_e(a,"open",i[1])},i(i){c||(C(r.$$.fragment,i),c=!0)},o(i){X(r.$$.fragment,i),c=!1},d(i){i&&j(t),ee(r),m=!1,f()}}}function Qe(l,t,n){const s=ue();let e=!1,{selectedGym:o}=t;function a(){e=this.checked,n(1,e)}const r=c=>{n(0,o=c.detail),s("changeGym",c.detail)};return l.$$set=c=>{"selectedGym"in c&&n(0,o=c.selectedGym)},[o,e,s,a,r]}class Ze extends T{constructor(t){super();U(this,t,Qe,xe,W,{selectedGym:0})}}const{window:oe}=Me;function $e(l){let t,n;return t=new Ye({props:{data:l[6]}}),t.$on("click",l[11]),{c(){Q(t.$$.fragment)},m(s,e){Z(t,s,e),n=!0},p(s,e){const o={};e&64&&(o.data=s[6]),t.$set(o)},i(s){n||(C(t.$$.fragment,s),n=!0)},o(s){X(t.$$.fragment,s),n=!1},d(s){ee(t,s)}}}function et(l){let t,n,s,e,o,a,r,c,m;x(l[9]),t=new Ze({}),t.$on("changeGym",l[10]);let f=l[2]&&$e(l);return{c(){Q(t.$$.fragment),n=O(),s=h("main"),e=h("div"),a=O(),f&&f.c(),_(e,"class","svgContainer svelte-w1xba1")},m(i,g){Z(t,i,g),N(i,n,g),N(i,s,g),u(s,e),e.innerHTML=l[4],u(s,a),f&&f.m(s,null),r=!0,c||(m=[H(oe,"resize",l[9]),Ne(o=l[8].call(null,e,l[4]))],c=!0)},p(i,[g]){(!r||g&16)&&(e.innerHTML=i[4]),o&&je(o.update)&&g&16&&o.update.call(null,i[4]),i[2]?f?(f.p(i,g),g&4&&C(f,1)):(f=$e(i),f.c(),C(f,1),f.m(s,null)):f&&(ge(),X(f,1,1,()=>{f=null}),me())},i(i){r||(C(t.$$.fragment,i),C(f),r=!0)},o(i){X(t.$$.fragment,i),X(f),r=!1},d(i){ee(t,i),i&&j(n),i&&j(s),f&&f.d(),c=!1,ce(m)}}}function tt(l,t,n){let s=!1,e=[],o="",a,r,c=1,m,f={},i=window.innerWidth,g=window.innerHeight;function M(k,I){return{update(){A(e,a)},destroy(){}}}function D(){te("svg.flex").attr("width",i).attr("height",g)}function A(k,I){const y=te("svg.flex").attr("width",i).attr("height",g);be("g#zoom_layer").each(function(){let d=this;te(d.parentNode).insert("g").attr("class","zoom").append(()=>d)});const p=y.select("#zoom_layer").node().getBBox();m=y.select("#zoom_layer").attr("transform",`translate(${-p.x}, ${-p.y})`).append("g").attr("class","routes"),n(3,e=m.selectAll("g").data(k).enter().append("g").attr("transform",d=>`translate(${p.width*d.position_x}, ${p.height*d.position_y})`).on("click",(d,b)=>{d.stopPropagation(),n(6,r=b),n(2,s=!0);const v=p.width/i*.75,w=p.width*b.position_x-p.x,$=p.height*b.position_y-p.y,K=i/2-2.5,Y=g/2-2.5;y.transition().duration(500).call(L.transform,ne.translate(-w*v+K,-$*v+Y).scale(v))}).append("foreignObject").attr("x",0).attr("y",0).attr("width",40).attr("height",40)),e.append("xhtml:div").html(d=>le(d.grade,"french_boulder")).attr("style",d=>De(d.id,I)).style("color",d=>Pe(qe(d.id,I)));const R=y.select(".zoom"),B=150,L=Le().translateExtent([[-B,-B],[p.width+B,p.height+B]]).scaleExtent([.1,2.5]).on("zoom",(d,b)=>{R.attr("transform",d.transform),c=Math.round(1/d.transform.k*100)/100}),z=g/p.height*.9,P=i/2-p.width/2*z,V=g/2-p.height/2*z;y.call(L).call(L.transform,ne.translate(P,V).scale(z)),y.select(".zoom").attr("transform",`translate(${P}, ${V}) scale(${z})`),be("g.map-region").on("click",function(d){d.stopPropagation();const b=y.select(`#${this.id}`).node().getBBox(),v=g/b.height*.8,w=-(b.x-p.x)*v,$=-(b.y-p.y)*v,K=g/2-b.height/2*v,Y=i/2-b.width/2*v;y.transition().duration(500).call(L.transform,ne.translate(w+Y,$+K).scale(v))})}fe(async()=>{n(3,[e,a,o]=await ve(8,"bruut_boulder_breda"),e,n(5,a),n(4,o));let k;function I(){k=requestAnimationFrame(I),m&&m.attr("style",`--dot-scale: ${c}`)}return I(),()=>cancelAnimationFrame(k)});function E(){n(1,g=oe.innerHeight),n(0,i=oe.innerWidth)}const J=async k=>{n(7,f=k.detail),n(3,[e,a,o]=await ve(f.id,f.id_name),e,n(5,a),n(4,o)),console.log(e,a)},G=()=>{n(2,s=!1)};return l.$$.update=()=>{l.$$.dirty&1&&D(),l.$$.dirty&2&&D()},[i,g,s,e,o,a,r,f,M,E,J,G]}class nt extends T{constructor(t){super();U(this,t,tt,et,W,{})}}new nt({target:document.body,props:{}});
