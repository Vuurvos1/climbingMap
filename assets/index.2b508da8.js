import{w as $e,S as T,i as U,s as W,e as oe,a as S,b as _,t as B,c as f,d as R,f as z,g as Oe,h as $,j as b,k as Y,l as ae,m as q,n as re,r as ie,o as Se,p as ce,q as ue,u as ze,v as fe,x as O,y as de,z as M,A as ge,B as me,C as pe,D as Ce,E as x,F as he,G as Q,H as Z,I as Ge,J as Ne,K as je,L as ee,M as _e,N as te,O as Le}from"./vendor.41c0da5c.js";const Me=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerpolicy&&(o.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?o.credentials="include":e.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(e){if(e.ep)return;e.ep=!0;const o=n(e);fetch(e.href,o)}};Me();const Xe=JSON.parse(localStorage.getItem("gyms")),ne=$e(Xe);ne.subscribe(l=>{typeof l=="object"&&l!=null&&localStorage.setItem("gyms",JSON.stringify(l))});function Pe(l){l.slice(0,1)==="#"&&(l=l.slice(1));const t=parseInt(l.substr(0,2),16),n=parseInt(l.substr(2,2),16),s=parseInt(l.substr(4,2),16);return(t*299+n*587+s*114)/1e3>=128?"black":"white"}const H={red:"#ce0000",green:"#0f480c",yellow:"#dcd138",orange:"#ff7200",black:"#000000",pink:"#ff00ed",blue:"#0093ff",purple:"#822fe0",lime:"#05ff00",white:"#ffffff"};function Ae(l,t){let n=t.filter((e,o)=>{for(const a of e.climb_groups)if(a.climb_id==l)return e});return n.length<1?n="aaa":n=n[0].name,n=n.toLowerCase(),n.split("/").length>1&&(n=n.split("/")[0]),H[n]?H[n]:"#0000ff"}function De(l,t){let n=t.filter((e,o)=>{for(const a of e.climb_groups)if(a.climb_id==l)return e});if(n.length<1?n="aaa":n=n[0].name,n=n.toLowerCase(),n.split("/").length>1){const e=n.split("/");return`--dot-col: linear-gradient(315deg, ${H[e[0]]} 50%, ${H[e[1]]} 50%)`}return`--dot-col: ${H[n]?H[n]:"#0000ff"}`}const He={uiaa:{2:"III",3:"IV-",3.44:"IV",3.89:"IV+",4.33:"V-",4.67:"V",4.92:"V+",5.5:"VI",5.21:"VI-",5.78:"VI+",6.06:"VII-",6.33:"VII",6.56:"VII+",6.78:"VIII-",7:"VIII",7.22:"VIII+",7.44:"IX-",7.67:"IX",7.89:"IX+",8.11:"X-",8.33:"X",8.56:"X+",8.78:"XI-",9:"XI",9.22:"XI+",9.44:"XII-"},yds:{2:"5.3",3:"5.4",4:"5.5",4.33:"5.6",4.67:"5.7",5:"5.8",5.33:"5.9",5.67:"5.10a",6:"5.10b",6.5:"5.11a",6.17:"5.10c",6.33:"5.10d",6.67:"5.11b",6.83:"5.11c",7:"5.11d",7.5:"5.12c",7.17:"5.12a",7.33:"5.12b",7.67:"5.12d",7.83:"5.13a",8:"5.13b",8.5:"5.14a",8.17:"5.13c",8.33:"5.13d",8.67:"5.14b",8.83:"5.14c",9:"5.14d",9.5:"5.15c",9.17:"5.15a",9.33:"5.15b"},french:{2:"2",2.5:"2",3:"3a",3.33:"3b",3.67:"3c",4:"4a",4.33:"4b",4.67:"4c",5:"5a",5.17:"5a+",5.33:"5b",5.5:"5b+",5.67:"5c",5.83:"5c+",6:"6a",6.17:"6a+",6.33:"6b",6.5:"6b+",6.67:"6c",6.83:"6c+",7:"7a",7.17:"7a+",7.33:"7b",7.5:"7b+",7.67:"7c",7.83:"7c+",8:"8a",8.17:"8a+",8.33:"8b",8.5:"8b+",8.67:"8c",8.83:"8c+",9:"9a",9.17:"9a+",9.33:"9b",9.5:"9b+"},french_boulder:{2:"2",2.5:"2",2.75:"2+",3:"3a",3.33:"3b",3.67:"3c",4:"4a",4.33:"4b",4.67:"4c",5:"5a",5.17:"5a+",5.33:"5b",5.5:"5b+",5.67:"5c",5.83:"5c+",6:"6a",6.17:"6a+",6.33:"6b",6.5:"6b+",6.67:"6c",6.83:"6c+",7:"7a",7.17:"7a+",7.33:"7b",7.5:"7b+",7.67:"7c",7.83:"7c+",8:"8a",8.17:"8a+",8.33:"8b",8.5:"8b+",8.67:"8c",8.83:"8c+",9:"9a",9.17:"9a+",9.33:"9b",9.5:"9b+"},french_rounded:{2:"2",2.5:"2",2.75:"2+",3:"3",3.33:"3+",3.67:"4-",4:"4",4.33:"4+",4.67:"5-",5:"5",5.5:"5+",6:"6a",6.5:"6b+",6.17:"6a+",6.33:"6b",6.67:"6c",6.83:"6c+",7:"7a",7.5:"7b+",7.17:"7a+",7.33:"7b",7.67:"7c",7.83:"7c+",8:"8a",8.5:"8b+",8.17:"8a+",8.33:"8b",8.67:"8c",8.83:"8c+",9:"9a",9.5:"9b+",9.17:"9a+",9.33:"9b"},ewbank:{2:"7",3:"8",3.33:"9",3.67:"10",4:"11",4.33:"12",4.66:"13",5:"14",5.33:"15",5.67:"16",6:"17",6.5:"20",6.17:"18",6.33:"19",6.67:"21",6.83:"22",7:"23",7.5:"26",7.17:"24",7.33:"25",7.67:"27",7.83:"28",8:"29",8.5:"32",8.17:"30",8.33:"31",8.67:"33",8.83:"34",9:"35",9.5:"38",9.17:"36",9.33:"37"},british:{2:"B0",3:"B1",3.83:"B2",5:"B3",6:"B4",6.28:"B5",6.56:"B6",6.83:"B7",7.11:"B8",7.39:"B9",7.67:"B10",7.87:"B11",8.08:"B12",8.29:"B13",8.5:"B14",8.67:"B15",8.83:"B16",9:"B17"},v_grade:{2:"VB",3:"VB",3.5:"V0-",4:"V0",4.5:"V0+",5:"V1",5.5:"V2",6:"V3",6.33:"V4",6.67:"V5",7:"V6",7.2:"V7",7.4:"V8",7.6:"V9",7.8:"V10",8:"V11",8.17:"V12",8.33:"V13",8.5:"V14",8.67:"V15",8.83:"V16",9:"V17"}};function se(l,t){return He[t][Number(l)]}const be="https://api.toplogger.nu/v1";function Je(l){return`https://cdn1.toplogger.nu/images/gyms/${l}/floorplan.svg`}function Re(l){const t={filters:{deleted:!1,live:!0}};return`${be}/gyms/${l}/climbs?json_params=${encodeURIComponent(JSON.stringify(t))}`}function qe(l){const t={filters:{gym_id:l,deleted:!1,live:!0,score_system:"none"},includes:["climb_groups"]};return`${be}/groups?json_params=${encodeURIComponent(JSON.stringify(t))}`}async function ye(l,t){const[n,s,e]=await Promise.all([fetch(Re(l)),fetch(qe(l)),fetch(Je(t))]).then(o=>Promise.all([o[0].json(),o[1].json(),o[2].text()])).then(o=>o).catch(o=>{throw new Error(o)});return[n,s,e]}function ve(l,t,n){const s=l.slice();return s[5]=t[n],s}function we(l){let t,n=l[1],s=[];for(let e=0;e<n.length;e+=1)s[e]=Ie(ve(l,n,e));return{c(){for(let e=0;e<s.length;e+=1)s[e].c();t=oe()},m(e,o){for(let a=0;a<s.length;a+=1)s[a].m(e,o);S(e,t,o)},p(e,o){if(o&2){n=e[1];let a;for(a=0;a<n.length;a+=1){const r=ve(e,n,a);s[a]?s[a].p(r,o):(s[a]=Ie(r),s[a].c(),s[a].m(t.parentNode,t))}for(;a<s.length;a+=1)s[a].d(1);s.length=n.length}},d(e){Oe(s,e),e&&z(t)}}}function Ie(l){let t,n=l[5].name+"",s,e;return{c(){t=_("option"),s=B(n),t.__value=e=l[5],t.value=t.__value},m(o,a){S(o,t,a),f(t,s)},p(o,a){a&2&&n!==(n=o[5].name+"")&&R(s,n),a&2&&e!==(e=o[5])&&(t.__value=e,t.value=t.__value)},d(o){o&&z(t)}}}function Ee(l){let t,n,s,e,o,a,r=l[1]&&we(l);return{c(){t=_("div"),n=_("label"),n.textContent="Gym",s=$(),e=_("select"),r&&r.c(),b(n,"for","gym"),b(e,"name",""),b(e,"id","gym"),l[0]===void 0&&Y(()=>l[3].call(e)),b(t,"class","select svelte-1f5yysq")},m(i,g){S(i,t,g),f(t,n),f(t,s),f(t,e),r&&r.m(e,null),ae(e,l[0]),o||(a=[q(e,"change",l[3]),q(e,"change",l[4])],o=!0)},p(i,[g]){i[1]?r?r.p(i,g):(r=we(i),r.c(),r.m(e,null)):r&&(r.d(1),r=null),g&3&&ae(e,i[0])},i:re,o:re,d(i){i&&z(t),r&&r.d(),o=!1,ie(a)}}}function Fe(l,t,n){let s;Se(l,ne,i=>n(1,s=i));let e;const o=ce();ue(async()=>{if(s==null){console.log("fetching gyms");const g=await(await fetch("https://api.toplogger.nu/v1/gyms/")).json();ne.set(g)}});function a(){e=ze(this),n(0,e)}return[e,s,o,a,()=>{o("change",e)}]}class Te extends T{constructor(t){super();U(this,t,Fe,Ee,W,{})}}function Ve(l){const t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=l?new Date(l):new Date,s=t[n.getMonth()],e=String(n.getDate()).padStart(2,"0"),o=n.getFullYear();return`${e} ${s} ${o}`}function ke(l){let t,n,s,e,o,a,r,i,g,c=se(l[0].grade,"french_boulder")+"",u,p,C,E,X=l[0].nr_of_ascends+"",J,G,I,w,m=l[0].average_opinion+"",P,F,N,V,j,L=Ve(l[0].date_set)+"",A,d,h,y,D;return{c(){t=_("div"),n=_("div"),s=_("h3"),s.textContent="Route data",e=$(),o=_("button"),o.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg>',a=$(),r=_("ul"),i=_("li"),g=B("grade: "),u=B(c),p=$(),C=_("li"),E=B("ascends: "),J=B(X),G=$(),I=_("li"),w=B("average opinion: "),P=B(m),F=B("/5.0"),N=$(),V=_("li"),j=B("date set: "),A=B(L),b(s,"class","svelte-1uei8sl"),b(o,"class","svelte-1uei8sl"),b(n,"class","preview__header svelte-1uei8sl"),b(i,"class","svelte-1uei8sl"),b(C,"class","svelte-1uei8sl"),b(I,"class","svelte-1uei8sl"),b(V,"class","svelte-1uei8sl"),b(t,"class","preview svelte-1uei8sl")},m(v,k){S(v,t,k),f(t,n),f(n,s),f(n,e),f(n,o),f(t,a),f(t,r),f(r,i),f(i,g),f(i,u),f(r,p),f(r,C),f(C,E),f(C,J),f(r,G),f(r,I),f(I,w),f(I,P),f(I,F),f(r,N),f(r,V),f(V,j),f(V,A),h=!0,y||(D=q(o,"click",l[1]),y=!0)},p(v,k){l=v,(!h||k&1)&&c!==(c=se(l[0].grade,"french_boulder")+"")&&R(u,c),(!h||k&1)&&X!==(X=l[0].nr_of_ascends+"")&&R(J,X),(!h||k&1)&&m!==(m=l[0].average_opinion+"")&&R(P,m),(!h||k&1)&&L!==(L=Ve(l[0].date_set)+"")&&R(A,L)},i(v){h||(Y(()=>{d||(d=fe(t,pe,{duration:200,easing:me},!0)),d.run(1)}),h=!0)},o(v){d||(d=fe(t,pe,{duration:200,easing:me},!1)),d.run(0),h=!1},d(v){v&&z(t),v&&d&&d.end(),y=!1,D()}}}function Ue(l){let t,n,s=l[0]&&ke(l);return{c(){s&&s.c(),t=oe()},m(e,o){s&&s.m(e,o),S(e,t,o),n=!0},p(e,[o]){e[0]?s?(s.p(e,o),o&1&&O(s,1)):(s=ke(e),s.c(),O(s,1),s.m(t.parentNode,t)):s&&(de(),M(s,1,1,()=>{s=null}),ge())},i(e){n||(O(s),n=!0)},o(e){M(s),n=!1},d(e){s&&s.d(e),e&&z(t)}}}function We(l,t,n){let{data:s}=t;function e(o){Ce.call(this,l,o)}return l.$$set=o=>{"data"in o&&n(0,s=o.data)},[s,e]}class Ke extends T{constructor(t){super();U(this,t,We,Ue,W,{data:0})}}function Ye(l){let t,n,s,e,o,a,r,i,g,c;return r=new Te({}),r.$on("change",l[4]),{c(){t=_("header"),n=_("label"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>',s=$(),e=_("input"),o=$(),a=_("div"),x(r.$$.fragment),b(n,"for","menuToggle"),b(e,"type","checkbox"),b(e,"id","menuToggle"),b(e,"class","svelte-zlos4x"),b(a,"class","menu svelte-zlos4x"),he(a,"open",l[1]),b(t,"class","svelte-zlos4x")},m(u,p){S(u,t,p),f(t,n),f(t,s),f(t,e),e.checked=l[1],f(t,o),f(t,a),Q(r,a,null),i=!0,g||(c=q(e,"change",l[3]),g=!0)},p(u,[p]){p&2&&(e.checked=u[1]),p&2&&he(a,"open",u[1])},i(u){i||(O(r.$$.fragment,u),i=!0)},o(u){M(r.$$.fragment,u),i=!1},d(u){u&&z(t),Z(r),g=!1,c()}}}function xe(l,t,n){const s=ce();let e=!1,{selectedGym:o}=t;function a(){e=this.checked,n(1,e)}const r=i=>{n(0,o=i.detail),s("changeGym",i.detail)};return l.$$set=i=>{"selectedGym"in i&&n(0,o=i.selectedGym)},[o,e,s,a,r]}class Qe extends T{constructor(t){super();U(this,t,xe,Ye,W,{selectedGym:0})}}const{window:le}=je;function Be(l){let t,n;return t=new Ke({props:{data:l[6]}}),t.$on("click",l[11]),{c(){x(t.$$.fragment)},m(s,e){Q(t,s,e),n=!0},p(s,e){const o={};e&64&&(o.data=s[6]),t.$set(o)},i(s){n||(O(t.$$.fragment,s),n=!0)},o(s){M(t.$$.fragment,s),n=!1},d(s){Z(t,s)}}}function Ze(l){let t,n,s,e,o,a,r,i,g;Y(l[9]),t=new Qe({}),t.$on("changeGym",l[10]);let c=l[2]&&Be(l);return{c(){x(t.$$.fragment),n=$(),s=_("main"),e=_("div"),a=$(),c&&c.c(),b(e,"class","svgContainer svelte-1tsoube")},m(u,p){Q(t,u,p),S(u,n,p),S(u,s,p),f(s,e),e.innerHTML=l[4],f(s,a),c&&c.m(s,null),r=!0,i||(g=[q(le,"resize",l[9]),Ge(o=l[8].call(null,e,l[4]))],i=!0)},p(u,[p]){(!r||p&16)&&(e.innerHTML=u[4]),o&&Ne(o.update)&&p&16&&o.update.call(null,u[4]),u[2]?c?(c.p(u,p),p&4&&O(c,1)):(c=Be(u),c.c(),O(c,1),c.m(s,null)):c&&(de(),M(c,1,1,()=>{c=null}),ge())},i(u){r||(O(t.$$.fragment,u),O(c),r=!0)},o(u){M(t.$$.fragment,u),M(c),r=!1},d(u){Z(t,u),u&&z(n),u&&z(s),c&&c.d(),i=!1,ie(g)}}}function et(l,t,n){let s=!1,e=[],o="",a,r,i={},g=window.innerWidth,c=window.innerHeight;function u(G,I){return{update(){C(e,a)},destroy(){}}}function p(){ee("svg.flex").attr("width",g).attr("height",c)}function C(G,I){const w=ee("svg.flex").attr("width",g).attr("height",c);_e("g#zoom_layer").each(function(){let d=this;ee(d.parentNode).insert("g").attr("class","zoom").append(()=>d)});const m=w.select("#zoom_layer").node().getBBox(),P=w.select("#zoom_layer").attr("transform",`translate(${-m.x}, ${-m.y})`).append("g").attr("class","routes");n(3,e=P.selectAll("g").data(G).enter().append("g").attr("transform",d=>`translate(${m.width*d.position_x}, ${m.height*d.position_y})`).attr("class","route").on("click",(d,h)=>{d.stopPropagation(),n(6,r=h),n(2,s=!0);const y=m.width/g*.75,D=m.width*h.position_x-m.x,v=m.height*h.position_y-m.y,k=g/2-2.5,K=c/2-2.5;w.transition().duration(500).call(V.transform,te.translate(-D*y+k,-v*y+K).scale(y))}).append("foreignObject").attr("x",0).attr("y",0).attr("width",1).attr("height",1).attr("class","scale")),e.append("xhtml:div").html(d=>se(d.grade,"french_boulder")).attr("style",d=>De(d.id,I)).style("color",d=>Pe(Ae(d.id,I)));const F=w.select(".zoom"),N=150,V=Le().translateExtent([[-N,-N],[m.width+N,m.height+N]]).scaleExtent([.1,2.5]).on("zoom",(d,h)=>{F.attr("transform",d.transform),P.attr("style",`--dot-scale: ${1/d.transform.k}`)}),j=c/m.height*.9,L=g/2-m.width/2*j,A=c/2-m.height/2*j;w.call(V).call(V.transform,te.translate(L,A).scale(j)),w.select(".zoom").attr("transform",`translate(${L}, ${A}) scale(${j})`),_e("g.map-region").on("click",function(d){d.stopPropagation();const h=w.select(`#${this.id}`).node().getBBox(),y=c/h.height*.8,D=-(h.x-m.x)*y,v=-(h.y-m.y)*y,k=c/2-h.height/2*y,K=g/2-h.width/2*y;w.transition().duration(500).call(V.transform,te.translate(D+K,v+k).scale(y))})}ue(async()=>{n(3,[e,a,o]=await ye(8,"bruut_boulder_breda"),e,n(5,a),n(4,o))});function E(){n(1,c=le.innerHeight),n(0,g=le.innerWidth)}const X=async G=>{n(7,i=G.detail),n(3,[e,a,o]=await ye(i.id,i.id_name),e,n(5,a),n(4,o)),console.log(e,a)},J=()=>{n(2,s=!1)};return l.$$.update=()=>{l.$$.dirty&1&&p(),l.$$.dirty&2&&p()},[g,c,s,e,o,a,r,i,u,E,X,J]}class tt extends T{constructor(t){super();U(this,t,et,Ze,W,{})}}new tt({target:document.body,props:{}});
