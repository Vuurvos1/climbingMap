const dt=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}};dt();function $(){}const ht=e=>e;function Je(e){return e()}function Ne(){return Object.create(null)}function X(e){e.forEach(Je)}function Ue(e){return typeof e=="function"}function G(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function mt(e){return Object.keys(e).length===0}function gt(e,...t){if(e==null)return $;const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function P(e,t,n){e.$$.on_destroy.push(gt(t,n))}function pt(e,t,n){return e.set(n),t}const Ye=typeof window!="undefined";let _t=Ye?()=>window.performance.now():()=>Date.now(),Ie=Ye?e=>requestAnimationFrame(e):$;const z=new Set;function xe(e){z.forEach(t=>{t.c(e)||(z.delete(t),t.f())}),z.size!==0&&Ie(xe)}function bt(e){let t;return z.size===0&&Ie(xe),{promise:new Promise(n=>{z.add(t={c:e,f:n})}),abort(){z.delete(t)}}}function m(e,t){e.appendChild(t)}function Ke(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function yt(e){const t=w("style");return wt(Ke(e),t),t.sheet}function wt(e,t){m(e.head||e,t)}function E(e,t,n){e.insertBefore(t,n||null)}function M(e){e.parentNode.removeChild(e)}function Qe(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function w(e){return document.createElement(e)}function K(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function B(e){return document.createTextNode(e)}function V(){return B(" ")}function Ze(){return B("")}function L(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function b(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function vt(e){return Array.from(e.childNodes)}function Z(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function Ee(e,t,n,r){n===null?e.style.removeProperty(t):e.style.setProperty(t,n,r?"important":"")}function de(e,t){for(let n=0;n<e.options.length;n+=1){const r=e.options[n];if(r.__value===t){r.selected=!0;return}}e.selectedIndex=-1}function et(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function je(e,t,n){e.classList[n?"add":"remove"](t)}function tt(e,t,{bubbles:n=!1,cancelable:r=!1}={}){const s=document.createEvent("CustomEvent");return s.initCustomEvent(e,n,r,t),s}const he=new Map;let me=0;function kt(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}function St(e,t){const n={stylesheet:yt(t),rules:{}};return he.set(e,n),n}function Ce(e,t,n,r,s,o,i,c=0){const a=16.666/r;let l=`{
`;for(let h=0;h<=1;h+=a){const g=t+(n-t)*o(h);l+=h*100+`%{${i(g,1-g)}}
`}const f=l+`100% {${i(n,1-n)}}
}`,u=`__svelte_${kt(f)}_${c}`,d=Ke(e),{stylesheet:p,rules:v}=he.get(d)||St(d,e);v[u]||(v[u]=!0,p.insertRule(`@keyframes ${u} ${f}`,p.cssRules.length));const k=e.style.animation||"";return e.style.animation=`${k?`${k}, `:""}${u} ${r}ms linear ${s}ms 1 both`,me+=1,u}function It(e,t){const n=(e.style.animation||"").split(", "),r=n.filter(t?o=>o.indexOf(t)<0:o=>o.indexOf("__svelte")===-1),s=n.length-r.length;s&&(e.style.animation=r.join(", "),me-=s,me||$t())}function $t(){Ie(()=>{me||(he.forEach(e=>{const{stylesheet:t}=e;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.rules={}}),he.clear())})}let re;function ne(e){re=e}function $e(){if(!re)throw new Error("Function called outside component initialization");return re}function nt(e){$e().$$.on_mount.push(e)}function Vt(e){$e().$$.after_update.push(e)}function Ve(){const e=$e();return(t,n,{cancelable:r=!1}={})=>{const s=e.$$.callbacks[t];if(s){const o=tt(t,n,{cancelable:r});return s.slice().forEach(i=>{i.call(e,o)}),!o.defaultPrevented}return!0}}function Bt(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(r=>r.call(this,t))}const ee=[],oe=[],ue=[],ve=[],st=Promise.resolve();let ke=!1;function rt(){ke||(ke=!0,st.then(lt))}function ot(){return rt(),st}function F(e){ue.push(e)}function it(e){ve.push(e)}const ye=new Set;let ce=0;function lt(){const e=re;do{for(;ce<ee.length;){const t=ee[ce];ce++,ne(t),Ot(t.$$)}for(ne(null),ee.length=0,ce=0;oe.length;)oe.pop()();for(let t=0;t<ue.length;t+=1){const n=ue[t];ye.has(n)||(ye.add(n),n())}ue.length=0}while(ee.length);for(;ve.length;)ve.pop()();ke=!1,ye.clear(),ne(e)}function Ot(e){if(e.fragment!==null){e.update(),X(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(F)}}let Q;function Mt(){return Q||(Q=Promise.resolve(),Q.then(()=>{Q=null})),Q}function we(e,t,n){e.dispatchEvent(tt(`${t?"intro":"outro"}${n}`))}const fe=new Set;let j;function ct(){j={r:0,c:[],p:j}}function at(){j.r||X(j.c),j=j.p}function O(e,t){e&&e.i&&(fe.delete(e),e.i(t))}function C(e,t,n,r){if(e&&e.o){if(fe.has(e))return;fe.add(e),j.c.push(()=>{fe.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}}const Nt={duration:0};function Fe(e,t,n,r){let s=t(e,n),o=r?0:1,i=null,c=null,a=null;function l(){a&&It(e,a)}function f(d,p){const v=d.b-o;return p*=Math.abs(v),{a:o,b:d.b,d:v,duration:p,start:d.start,end:d.start+p,group:d.group}}function u(d){const{delay:p=0,duration:v=300,easing:k=ht,tick:h=$,css:g}=s||Nt,_={start:_t()+p,b:d};d||(_.group=j,j.r+=1),i||c?c=_:(g&&(l(),a=Ce(e,o,d,v,p,k,g)),d&&h(0,1),i=f(_,v),F(()=>we(e,d,"start")),bt(I=>{if(c&&I>c.start&&(i=f(c,v),c=null,we(e,i.b,"start"),g&&(l(),a=Ce(e,o,i.b,i.duration,0,k,s.css))),i){if(I>=i.end)h(o=i.b,1-o),we(e,i.b,"end"),c||(i.b?l():--i.group.r||X(i.group.c)),i=null;else if(I>=i.start){const S=I-i.start;o=i.a+i.d*k(S/i.duration),h(o,1-o)}}return!!(i||c)}))}return{run(d){Ue(s)?Mt().then(()=>{s=s(),u(d)}):u(d)},end(){l(),i=c=null}}}const Et=typeof window!="undefined"?window:typeof globalThis!="undefined"?globalThis:global;function ut(e,t,n){const r=e.$$.props[t];r!==void 0&&(e.$$.bound[r]=n,n(e.$$.ctx[r]))}function ie(e){e&&e.c()}function W(e,t,n,r){const{fragment:s,on_mount:o,on_destroy:i,after_update:c}=e.$$;s&&s.m(t,n),r||F(()=>{const a=o.map(Je).filter(Ue);i?i.push(...a):X(a),e.$$.on_mount=[]}),c.forEach(F)}function q(e,t){const n=e.$$;n.fragment!==null&&(X(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function jt(e,t){e.$$.dirty[0]===-1&&(ee.push(e),rt(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function J(e,t,n,r,s,o,i,c=[-1]){const a=re;ne(e);const l=e.$$={fragment:null,ctx:null,props:o,update:$,not_equal:s,bound:Ne(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(a?a.$$.context:[])),callbacks:Ne(),dirty:c,skip_bound:!1,root:t.target||a.$$.root};i&&i(l.root);let f=!1;if(l.ctx=n?n(e,t.props||{},(u,d,...p)=>{const v=p.length?p[0]:d;return l.ctx&&s(l.ctx[u],l.ctx[u]=v)&&(!l.skip_bound&&l.bound[u]&&l.bound[u](v),f&&jt(e,u)),d}):[],l.update(),f=!0,X(l.before_update),l.fragment=r?r(l.ctx):!1,t.target){if(t.hydrate){const u=vt(t.target);l.fragment&&l.fragment.l(u),u.forEach(M)}else l.fragment&&l.fragment.c();t.intro&&O(e.$$.fragment),W(e,t.target,t.anchor,t.customElement),lt()}ne(a)}class U{$destroy(){q(this,1),this.$destroy=$}$on(t,n){const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}$set(t){this.$$set&&!mt(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const R=[];function Be(e,t=$){let n;const r=new Set;function s(c){if(G(e,c)&&(e=c,n)){const a=!R.length;for(const l of r)l[1](),R.push(l,e);if(a){for(let l=0;l<R.length;l+=2)R[l][0](R[l+1]);R.length=0}}}function o(c){s(c(e))}function i(c,a=$){const l=[c,a];return r.add(l),r.size===1&&(n=t(s)||$),c(e),()=>{r.delete(l),r.size===0&&(n(),n=null)}}return{set:s,update:o,subscribe:i}}const Ct=JSON.parse(localStorage.getItem("gyms")),ge=Be(Ct);ge.subscribe(e=>{typeof e=="object"&&e!=null&&localStorage.setItem("gyms",JSON.stringify(e))});const pe=Be(JSON.parse(localStorage.getItem("gym")));pe.subscribe(e=>{typeof e=="object"&&e!=null&&localStorage.setItem("gym",JSON.stringify(e))});const se=Be(void 0);function te(e,t,n){this.k=e,this.x=t,this.y=n}te.prototype={constructor:te,scale:function(e){return e===1?this:new te(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new te(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};new te(1,0,0);const ae={uiaa:{2:"III",3:"IV-",3.44:"IV",3.89:"IV+",4.33:"V-",4.67:"V",4.92:"V+",5.5:"VI",5.21:"VI-",5.78:"VI+",6.06:"VII-",6.33:"VII",6.56:"VII+",6.78:"VIII-",7:"VIII",7.22:"VIII+",7.44:"IX-",7.67:"IX",7.89:"IX+",8.11:"X-",8.33:"X",8.56:"X+",8.78:"XI-",9:"XI",9.22:"XI+",9.44:"XII-"},yds:{2:"5.3",3:"5.4",4:"5.5",4.33:"5.6",4.67:"5.7",5:"5.8",5.33:"5.9",5.67:"5.10a",6:"5.10b",6.5:"5.11a",6.17:"5.10c",6.33:"5.10d",6.67:"5.11b",6.83:"5.11c",7:"5.11d",7.5:"5.12c",7.17:"5.12a",7.33:"5.12b",7.67:"5.12d",7.83:"5.13a",8:"5.13b",8.5:"5.14a",8.17:"5.13c",8.33:"5.13d",8.67:"5.14b",8.83:"5.14c",9:"5.14d",9.5:"5.15c",9.17:"5.15a",9.33:"5.15b"},french:{2:"2",2.5:"2",3:"3a",3.33:"3b",3.67:"3c",4:"4a",4.33:"4b",4.67:"4c",5:"5a",5.17:"5a+",5.33:"5b",5.5:"5b+",5.67:"5c",5.83:"5c+",6:"6a",6.17:"6a+",6.33:"6b",6.5:"6b+",6.67:"6c",6.83:"6c+",7:"7a",7.17:"7a+",7.33:"7b",7.5:"7b+",7.67:"7c",7.83:"7c+",8:"8a",8.17:"8a+",8.33:"8b",8.5:"8b+",8.67:"8c",8.83:"8c+",9:"9a",9.17:"9a+",9.33:"9b",9.5:"9b+"},french_boulder:{2:"2",2.5:"2",2.75:"2+",3:"3a",3.33:"3b",3.67:"3c",4:"4a",4.33:"4b",4.67:"4c",5:"5a",5.17:"5a+",5.33:"5b",5.5:"5b+",5.67:"5c",5.83:"5c+",6:"6a",6.17:"6a+",6.33:"6b",6.5:"6b+",6.67:"6c",6.83:"6c+",7:"7a",7.17:"7a+",7.33:"7b",7.5:"7b+",7.67:"7c",7.83:"7c+",8:"8a",8.17:"8a+",8.33:"8b",8.5:"8b+",8.67:"8c",8.83:"8c+",9:"9a",9.17:"9a+",9.33:"9b",9.5:"9b+"},french_rounded:{2:"2",2.5:"2",2.75:"2+",3:"3",3.33:"3+",3.67:"4-",4:"4",4.33:"4+",4.67:"5-",5:"5",5.5:"5+",6:"6a",6.5:"6b+",6.17:"6a+",6.33:"6b",6.67:"6c",6.83:"6c+",7:"7a",7.5:"7b+",7.17:"7a+",7.33:"7b",7.67:"7c",7.83:"7c+",8:"8a",8.5:"8b+",8.17:"8a+",8.33:"8b",8.67:"8c",8.83:"8c+",9:"9a",9.5:"9b+",9.17:"9a+",9.33:"9b"},ewbank:{2:"7",3:"8",3.33:"9",3.67:"10",4:"11",4.33:"12",4.66:"13",5:"14",5.33:"15",5.67:"16",6:"17",6.5:"20",6.17:"18",6.33:"19",6.67:"21",6.83:"22",7:"23",7.5:"26",7.17:"24",7.33:"25",7.67:"27",7.83:"28",8:"29",8.5:"32",8.17:"30",8.33:"31",8.67:"33",8.83:"34",9:"35",9.5:"38",9.17:"36",9.33:"37"},british:{2:"B0",3:"B1",3.83:"B2",5:"B3",6:"B4",6.28:"B5",6.56:"B6",6.83:"B7",7.11:"B8",7.39:"B9",7.67:"B10",7.87:"B11",8.08:"B12",8.29:"B13",8.5:"B14",8.67:"B15",8.83:"B16",9:"B17"},v_grade:{2:"VB",3:"VB",3.5:"V0-",4:"V0",4.5:"V0+",5:"V1",5.5:"V2",6:"V3",6.33:"V4",6.67:"V5",7:"V6",7.2:"V7",7.4:"V8",7.6:"V9",7.8:"V10",8:"V11",8.17:"V12",8.33:"V13",8.5:"V14",8.67:"V15",8.83:"V16",9:"V17"}};function Te(e,t){if(!ae[t][Number(e)]){const n=Object.keys(ae[t]).map(o=>Number(o)),r=Number(e),s=Math.max(...n.filter(o=>o<=r));return ae[t][s]}return ae[t][Number(e)]}const ft="https://api.toplogger.nu/v1";function Ft(e){return`https://cdn1.toplogger.nu/images/gyms/${e}/floorplan.svg`}function Tt(e){const t={filters:{deleted:!1,live:!0}};return`${ft}/gyms/${e}/climbs?json_params=${encodeURIComponent(JSON.stringify(t))}`}function At(e){const t={filters:{gym_id:e,deleted:!1,live:!0,score_system:"none"},includes:["climb_groups"]};return`${ft}/groups?json_params=${encodeURIComponent(JSON.stringify(t))}`}async function Ae(e,t){const[n,r,s]=await Promise.all([fetch(Tt(e)),fetch(At(e)),fetch(Ft(t))]).then(o=>Promise.all([o[0].json(),o[1].json(),o[2].text()])).then(o=>o).catch(o=>{throw new Error(o)});return[n,r,s]}function Dt(e){const t=e-1;return t*t*t+1}function De(e){return--e*e*e*e*e+1}function Le(e,{delay:t=0,duration:n=400,easing:r=Dt}={}){const s=getComputedStyle(e),o=+s.opacity,i=parseFloat(s.height),c=parseFloat(s.paddingTop),a=parseFloat(s.paddingBottom),l=parseFloat(s.marginTop),f=parseFloat(s.marginBottom),u=parseFloat(s.borderTopWidth),d=parseFloat(s.borderBottomWidth);return{delay:t,duration:n,easing:r,css:p=>`overflow: hidden;opacity: ${Math.min(p*20,1)*o};height: ${p*i}px;padding-top: ${p*c}px;padding-bottom: ${p*a}px;margin-top: ${p*l}px;margin-bottom: ${p*f}px;border-top-width: ${p*u}px;border-bottom-width: ${p*d}px;`}}function Xe(e){const t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=e?new Date(e):new Date,r=t[n.getMonth()],s=String(n.getDate()).padStart(2,"0"),o=n.getFullYear();return`${s} ${r} ${o}`}function Ge(e){let t,n,r,s,o,i,c,a,l,f=Te(e[0].grade,"french_boulder")+"",u,d,p,v,k=e[0].nr_of_ascends+"",h,g,_,I,S=e[0].average_opinion+"",y,N,Y,x,Oe,le=Xe(e[0].date_set)+"",_e,T,A,be,Me;return{c(){t=w("div"),n=w("div"),r=w("h3"),r.textContent="Route data",s=V(),o=w("button"),o.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"></polyline></svg>',i=V(),c=w("ul"),a=w("li"),l=B("grade: "),u=B(f),d=V(),p=w("li"),v=B("ascends: "),h=B(k),g=V(),_=w("li"),I=B("average opinion: "),y=B(S),N=B("/5.0"),Y=V(),x=w("li"),Oe=B("date set: "),_e=B(le),b(r,"class","mr-auto"),b(o,"class","bg-none border-none leading-none"),b(n,"class","flex flex-row items-center mb-4"),b(a,"class","list-none"),b(p,"class","list-none"),b(_,"class","list-none"),b(x,"class","list-none"),b(t,"class","preview fixed bottom-0 left-0 w-screen px-4 py-4 bg-white shadow-lg md:w-max md:right-4 md:left-auto md:bottom-4")},m(D,H){E(D,t,H),m(t,n),m(n,r),m(n,s),m(n,o),m(t,i),m(t,c),m(c,a),m(a,l),m(a,u),m(c,d),m(c,p),m(p,v),m(p,h),m(c,g),m(c,_),m(_,I),m(_,y),m(_,N),m(c,Y),m(c,x),m(x,Oe),m(x,_e),A=!0,be||(Me=L(o,"click",e[1]),be=!0)},p(D,H){e=D,(!A||H&1)&&f!==(f=Te(e[0].grade,"french_boulder")+"")&&Z(u,f),(!A||H&1)&&k!==(k=e[0].nr_of_ascends+"")&&Z(h,k),(!A||H&1)&&S!==(S=e[0].average_opinion+"")&&Z(y,S),(!A||H&1)&&le!==(le=Xe(e[0].date_set)+"")&&Z(_e,le)},i(D){A||(F(()=>{T||(T=Fe(t,Le,{duration:200,easing:De},!0)),T.run(1)}),A=!0)},o(D){T||(T=Fe(t,Le,{duration:200,easing:De},!1)),T.run(0),A=!1},d(D){D&&M(t),D&&T&&T.end(),be=!1,Me()}}}function Lt(e){let t,n,r=e[0]&&Ge(e);return{c(){r&&r.c(),t=Ze()},m(s,o){r&&r.m(s,o),E(s,t,o),n=!0},p(s,[o]){s[0]?r?(r.p(s,o),o&1&&O(r,1)):(r=Ge(s),r.c(),O(r,1),r.m(t.parentNode,t)):r&&(ct(),C(r,1,1,()=>{r=null}),at())},i(s){n||(O(r),n=!0)},o(s){C(r),n=!1},d(s){r&&r.d(s),s&&M(t)}}}function Xt(e,t,n){let{data:r}=t;function s(o){Bt.call(this,e,o)}return e.$$set=o=>{"data"in o&&n(0,r=o.data)},[r,s]}class Gt extends U{constructor(t){super(),J(this,t,Xt,Lt,G,{data:0})}}function He(e,t,n){const r=e.slice();return r[6]=t[n],r}function Re(e){let t,n=e[1],r=[];for(let s=0;s<n.length;s+=1)r[s]=ze(He(e,n,s));return{c(){for(let s=0;s<r.length;s+=1)r[s].c();t=Ze()},m(s,o){for(let i=0;i<r.length;i+=1)r[i].m(s,o);E(s,t,o)},p(s,o){if(o&2){n=s[1];let i;for(i=0;i<n.length;i+=1){const c=He(s,n,i);r[i]?r[i].p(c,o):(r[i]=ze(c),r[i].c(),r[i].m(t.parentNode,t))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},d(s){Qe(r,s),s&&M(t)}}}function ze(e){let t,n=e[6].name+"",r,s;return{c(){t=w("option"),r=B(n),t.__value=s=e[6],t.value=t.__value},m(o,i){E(o,t,i),m(t,r)},p(o,i){i&2&&n!==(n=o[6].name+"")&&Z(r,n),i&2&&s!==(s=o[6])&&(t.__value=s,t.value=t.__value)},d(o){o&&M(t)}}}function Ht(e){let t,n,r,s,o=e[1]&&Object.keys(e[1]).length!=0&&e[1],i,c,a=o&&Re(e);return{c(){t=w("div"),n=w("label"),n.textContent="Gym",r=V(),s=w("select"),a&&a.c(),b(n,"class","mb-1 block font-bold"),b(n,"for","gym"),b(s,"class","px-2 py-0.5 border-2 rounded w-full"),b(s,"name",""),b(s,"id","gym"),e[0]===void 0&&F(()=>e[3].call(s)),b(t,"class","p-4")},m(l,f){E(l,t,f),m(t,n),m(t,r),m(t,s),a&&a.m(s,null),de(s,e[0]),i||(c=[L(s,"change",e[3]),L(s,"change",e[4])],i=!0)},p(l,[f]){f&2&&(o=l[1]&&Object.keys(l[1]).length!=0&&l[1]),o?a?a.p(l,f):(a=Re(l),a.c(),a.m(s,null)):a&&(a.d(1),a=null),f&3&&de(s,l[0])},i:$,o:$,d(l){l&&M(t),a&&a.d(),i=!1,X(c)}}}function Rt(e,t,n){let r;P(e,ge,l=>n(1,r=l)),(r==null||Object.keys(r).length==0)&&i();let{selected:s}=t;const o=Ve();async function i(){const f=await(await fetch("https://api.toplogger.nu/v1/gyms/")).json();return ge.set(f),f}function c(){s=et(this),n(0,s)}const a=()=>{pe.set(s),o("change",s)};return e.$$set=l=>{"selected"in l&&n(0,s=l.selected)},[s,r,o,c,a]}class zt extends U{constructor(t){super(),J(this,t,Rt,Ht,G,{selected:0})}}function Pe(e,t,n){const r=e.slice();return r[5]=t[n],r}function We(e){let t,n=e[5].name+"",r,s;return{c(){t=w("option"),r=B(n),t.__value=s=e[5].value,t.value=t.__value},m(o,i){E(o,t,i),m(t,r)},p:$,d(o){o&&M(t)}}}function Pt(e){let t,n,r,s,o,i,c=e[2],a=[];for(let l=0;l<c.length;l+=1)a[l]=We(Pe(e,c,l));return{c(){t=w("div"),n=w("label"),n.textContent="Grade system",r=V(),s=w("select");for(let l=0;l<a.length;l+=1)a[l].c();b(n,"class","mb-1 block font-bold"),b(n,"for","gradeSystem"),b(s,"class","px-2 py-0.5 border-2 rounded w-full"),b(s,"name",""),b(s,"id","gradeSystem"),e[0]===void 0&&F(()=>e[3].call(s)),b(t,"class","p-4")},m(l,f){E(l,t,f),m(t,n),m(t,r),m(t,s);for(let u=0;u<a.length;u+=1)a[u].m(s,null);de(s,e[0]),o||(i=[L(s,"change",e[3]),L(s,"change",e[4])],o=!0)},p(l,[f]){if(f&4){c=l[2];let u;for(u=0;u<c.length;u+=1){const d=Pe(l,c,u);a[u]?a[u].p(d,f):(a[u]=We(d),a[u].c(),a[u].m(s,null))}for(;u<a.length;u+=1)a[u].d(1);a.length=c.length}f&5&&de(s,l[0])},i:$,o:$,d(l){l&&M(t),Qe(a,l),o=!1,X(i)}}}function Wt(e,t,n){let r;const s=Ve(),o=[{name:"Same as gym",value:void 0},{name:"UIAA",value:"uiaa"},{name:"YDS",value:"yds"},{name:"French",value:"french"},{name:"French boulder",value:"french_boulder"},{name:"French rounded",value:"french_rounded"},{name:"Ewbank",value:"ewbank"},{name:"British",value:"british"},{name:"V Grade",value:"v_grade"}];function i(){r=et(this),n(0,r),n(2,o)}return[r,s,o,i,()=>{se.set(r),s("change",r)}]}class qt extends U{constructor(t){super(),J(this,t,Wt,Pt,G,{})}}function Jt(e){let t,n,r,s,o,i,c,a,l,f,u,d,p;function v(h){e[4](h)}let k={};return e[1]!==void 0&&(k.selected=e[1]),c=new zt({props:k}),oe.push(()=>ut(c,"selected",v)),c.$on("change",e[5]),f=new qt({}),f.$on("change",Ut),{c(){t=w("header"),n=w("label"),n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>',r=V(),s=w("input"),o=V(),i=w("div"),ie(c.$$.fragment),l=V(),ie(f.$$.fragment),b(n,"for","menuToggle"),b(n,"class","z-20"),b(s,"type","checkbox"),b(s,"id","menuToggle"),b(s,"class","w-0 h-0 hidden"),b(i,"class","menu fixed top-0 left-0 h-screen w-80 pt-12 bg-white shadow-lg svelte-3241ld"),je(i,"open",e[0]),b(t,"class","fixed top-0 left-0 z-30 flex items-center px-4 py-2 bg-white shadow-lg svelte-3241ld")},m(h,g){E(h,t,g),m(t,n),m(t,r),m(t,s),s.checked=e[0],m(t,o),m(t,i),W(c,i,null),m(i,l),W(f,i,null),u=!0,d||(p=L(s,"change",e[3]),d=!0)},p(h,[g]){g&1&&(s.checked=h[0]);const _={};!a&&g&2&&(a=!0,_.selected=h[1],it(()=>a=!1)),c.$set(_),g&1&&je(i,"open",h[0])},i(h){u||(O(c.$$.fragment,h),O(f.$$.fragment,h),u=!0)},o(h){C(c.$$.fragment,h),C(f.$$.fragment,h),u=!1},d(h){h&&M(t),q(c),q(f),d=!1,p()}}}const Ut=e=>{};function Yt(e,t,n){let r,s;P(e,ge,d=>n(6,r=d)),P(e,pe,d=>n(7,s=d));const o=Ve();let i=!1,c=r==null?void 0:r.findIndex(d=>(d==null?void 0:d.id)===(s==null?void 0:s.id)),a=c>-1?r[c]:{};function l(){i=this.checked,n(0,i)}function f(d){a=d,n(1,a)}return[i,a,o,l,f,d=>{o("changeGym",d.detail)}]}class xt extends U{constructor(t){super(),J(this,t,Yt,Jt,G,{})}}function Kt(e){let t,n,r,s,o,i,c=`translate(${e[8]}px, ${e[9]}px) scale(${e[10]})`,a,l;return F(e[14]),{c(){t=w("div"),n=K("svg"),r=K("g"),s=K("g"),o=K("g"),i=K("g"),b(o,"class","map"),b(o,"id","map"),b(i,"class","routes"),b(s,"class","map-scale"),b(r,"class","map-translate svelte-otwaa6"),Ee(r,"transform",c,!1),b(n,"width",e[12]),b(n,"height",e[11]),b(n,"class","svelte-otwaa6")},m(f,u){E(f,t,u),m(t,n),m(n,r),m(r,s),m(s,o),o.innerHTML=e[2],e[15](o),m(s,i),a||(l=L(window,"resize",e[14]),a=!0)},p(f,[u]){u&4&&(o.innerHTML=f[2]),u&1792&&c!==(c=`translate(${f[8]}px, ${f[9]}px) scale(${f[10]})`)&&Ee(r,"transform",c,!1),u&4096&&b(n,"width",f[12]),u&2048&&b(n,"height",f[11])},i:$,o:$,d(f){f&&M(t),e[15](null),a=!1,l()}}}function Qt(e,t,n){let r,s,o;P(e,se,y=>n(13,o=y));let{climbs:i=[]}=t,{groups:c=[]}=t,{mapSvg:a}=t,l,f,u,d=0,p=0,v=0,k=0,h=1;async function g(){if(l){await ot();const y=l.getBBox();console.log(l.getBBox());const N=s/y.height*.9;r/2-y.width/2*N,s/2-y.height/2*N,n(10,h=N),n(6,d=y.width),n(7,p=y.height),n(8,v=-y.x*h),n(9,k=-y.y*h)}}nt(async()=>{if(l){const{width:y,height:N}=l.getBBox();n(6,d=y),n(7,p=N)}});function _(){n(11,s=window.innerHeight),n(12,r=window.innerWidth)}function I(y){oe[y?"unshift":"push"](()=>{l=y,n(3,l)})}const S=y=>{n(4,f=y),n(5,u=!0)};return e.$$set=y=>{"climbs"in y&&n(0,i=y.climbs),"groups"in y&&n(1,c=y.groups),"mapSvg"in y&&n(2,a=y.mapSvg)},e.$$.update=()=>{e.$$.dirty&4&&g(),e.$$.dirty&4},n(12,r=0),n(11,s=0),[i,c,a,l,f,u,d,p,v,k,h,s,r,o,_,I,S]}class Zt extends U{constructor(t){super(),J(this,t,Qt,Kt,G,{climbs:0,groups:1,mapSvg:2})}}const{window:Se}=Et;function qe(e){let t,n;return t=new Gt({props:{data:e[6]}}),t.$on("click",e[13]),{c(){ie(t.$$.fragment)},m(r,s){W(t,r,s),n=!0},p(r,s){const o={};s&64&&(o.data=r[6]),t.$set(o)},i(r){n||(O(t.$$.fragment,r),n=!0)},o(r){C(t.$$.fragment,r),n=!1},d(r){q(t,r)}}}function en(e){let t,n,r,s,o,i,c,a,l,f,u,d,p;F(e[10]);function v(g){e[11](g)}let k={};e[7]!==void 0&&(k.selected=e[7]),t=new xt({props:k}),oe.push(()=>ut(t,"selected",v)),t.$on("changeGym",e[12]),c=new Zt({props:{climbs:e[4],groups:e[5],mapSvg:e[0]}});let h=e[3]&&qe(e);return{c(){ie(t.$$.fragment),r=V(),s=w("main"),o=w("div"),i=V(),ie(c.$$.fragment),a=V(),l=w("div"),f=V(),h&&h.c(),b(o,"class","svgContainer h-screen hidden svelte-1uvat6c")},m(g,_){W(t,g,_),E(g,r,_),E(g,s,_),m(s,o),o.innerHTML=e[0],m(s,i),W(c,s,null),m(s,a),m(s,l),m(s,f),h&&h.m(s,null),u=!0,d||(p=L(Se,"resize",e[10]),d=!0)},p(g,[_]){const I={};!n&&_&128&&(n=!0,I.selected=g[7],it(()=>n=!1)),t.$set(I),(!u||_&1)&&(o.innerHTML=g[0]);const S={};_&16&&(S.climbs=g[4]),_&32&&(S.groups=g[5]),_&1&&(S.mapSvg=g[0]),c.$set(S),g[3]?h?(h.p(g,_),_&8&&O(h,1)):(h=qe(g),h.c(),O(h,1),h.m(s,null)):h&&(ct(),C(h,1,1,()=>{h=null}),at())},i(g){u||(O(t.$$.fragment,g),O(c.$$.fragment,g),O(h),u=!0)},o(g){C(t.$$.fragment,g),C(c.$$.fragment,g),C(h),u=!1},d(g){q(t,g),g&&M(r),g&&M(s),q(c),h&&h.d(),d=!1,p()}}}function tn(e,t,n){let r,s;P(e,pe,_=>n(8,r=_)),P(e,se,_=>n(9,s=_));let o=!1,i=[],c="",a,l,f=r!=null&&r.id?r:{},u=window.innerWidth,d=window.innerHeight;async function p(){await ot(),document.querySelector("#map").getBoundingClientRect()}Vt(()=>{}),se.subscribe(_=>{}),nt(async()=>{const _=r!=null&&r.id_name?r.id_name:"bruut_boulder_breda",I=r!=null&&r.id?r.id:8;n(4,[i,a,c]=await Ae(I,_),i,n(5,a),n(0,c));const y=new DOMParser().parseFromString(c,"text/html");n(0,c=y.querySelector("#zoom_layer").innerHTML);let N;function Y(){N=requestAnimationFrame(Y)}return Y(),()=>cancelAnimationFrame(N)});function v(){n(2,d=Se.innerHeight),n(1,u=Se.innerWidth)}function k(_){f=_,n(7,f)}const h=async _=>{const S=await(await fetch(`https://api.toplogger.nu/v1/gyms/${_.detail.slug}`)).json();pt(se,s=S.grading_system_boulders||S.grading_system_routes,s),n(4,[i,a,c]=await Ae(r.id,r.id_name),i,n(5,a),n(0,c))},g=()=>{n(3,o=!1)};return e.$$.update=()=>{e.$$.dirty&2,e.$$.dirty&4,e.$$.dirty&1&&p(),e.$$.dirty&1&&c&&document.querySelector("#map svg")},[c,u,d,o,i,a,l,f,r,s,v,k,h,g]}class nn extends U{constructor(t){super(),J(this,t,tn,en,G,{})}}new nn({target:document.body,props:{}});
