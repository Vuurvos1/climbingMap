import{w as t,S as e,i as n,s as r,e as s,a as o,t as a,b as i,c as l,d as c,f as d,n as f,g as u,h as p,j as g,m,l as h,k as y,o as $,p as w,q as b,r as v,u as x,v as _,x as N,y as S,z as j,A as z,B as k}from"./vendor.65040f49.js";!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const n of t)if("childList"===n.type)for(const t of n.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerpolicy&&(e.referrerPolicy=t.referrerpolicy),"use-credentials"===t.crossorigin?e.credentials="include":"anonymous"===t.crossorigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();t(JSON.parse(localStorage.getItem("gyms"))).subscribe((t=>{"object"==typeof t&&null!=t&&localStorage.setItem("gyms",JSON.stringify(t))}));function L(t){let e,n,r,p,g,m=JSON.stringify(t[0],void 0,2)+"";return{c(){e=s("div"),n=s("h3"),n.textContent="Route data",r=o(),p=s("pre"),g=a(m),i(e,"class","preview svelte-1l1didp")},m(t,s){l(t,e,s),c(e,n),c(e,r),c(e,p),c(p,g)},p(t,[e]){1&e&&m!==(m=JSON.stringify(t[0],void 0,2)+"")&&d(g,m)},i:f,o:f,d(t){t&&u(e)}}}function O(t,e,n){let{data:r}=e;return t.$$set=t=>{"data"in t&&n(0,r=t.data)},[r]}class C extends e{constructor(t){super(),n(this,t,O,L,r,{data:0})}}const{window:J}=N;function B(t){let e,n,r,a,d,f,_,N;return p(t[4]),d=new C({props:{data:t[3]}}),{c(){e=s("main"),n=s("div"),a=o(),g(d.$$.fragment),i(n,"class","svgContainer svelte-1ajd62j")},m(s,o){l(s,e,o),c(e,n),n.innerHTML=t[2],c(e,a),m(d,e,null),f=!0,_||(N=[h(J,"resize",t[4]),y(r=P.call(null,n,t[2]))],_=!0)},p(t,[e]){(!f||4&e)&&(n.innerHTML=t[2]),r&&$(r.update)&&4&e&&r.update.call(null,t[2]);const s={};8&e&&(s.data=t[3]),d.$set(s)},i(t){f||(w(d.$$.fragment,t),f=!0)},o(t){b(d.$$.fragment,t),f=!1},d(t){t&&u(e),v(d),_=!1,x(N)}}}const I="https://api.toplogger.nu/v1";function P(t,e){return{update(){},destroy(){}}}function H(t){const e={filters:{gym_id:t,deleted:!1,live:!0,score_system:"none"},includes:["climb_groups"]};return`${I}/groups?json_params=${encodeURIComponent(JSON.stringify(e))}`}function A(t,e,n){let r,s=[],o="",a=window.innerWidth,i=window.innerHeight;function l(t,e){const o=S("svg.flex").attr("width",a).attr("height",i);j("g#zoom_layer").each((function(){let t=this;S(t.parentNode).insert("g").attr("class","zoom").append((()=>t))}));const l=o.select("#zoom_layer").node().getBBox(),c=o.select("#zoom_layer").attr("transform",`translate(${-l.x}, ${-l.y})`).append("g").attr("class","routes");s=c.selectAll("g").data(t).enter().append("g").attr("transform",(t=>`translate(${l.width*t.position_x}, ${l.height*t.position_y})`)).attr("class","route").on("click",((t,e)=>{t.stopPropagation(),n(3,r=e);const s=l.width/a*.75,c=l.width*e.position_x-l.x,f=l.height*e.position_y-l.y,u=a/2-2.5,p=i/2-2.5;o.transition().duration(500).call(d.transform,z.translate(-c*s+u,-f*s+p).scale(s))})).append("g").attr("class","scale"),s.append("circle").attr("r",20).style("fill",(t=>`#${function(t,e){let n=e.filter(((e,n)=>{for(const r of e.climb_groups)if(r.climb_id==t)return e}));n=n.length<1?"aaa":n[0].name;const r={red:"ce0000",green:"0f480c",yellow:"dcd138",orange:"ff7200",black:"000000",pink:"ff00ed",blue:"0093ff",purple:"822fe0",lime:"05ff00",white:"ffffff"};return r[n.toLowerCase()]?r[n.toLowerCase()]:"0000ff"}(t.id,e)}`)),s.append("text").attr("dy",5).text((t=>function(t){const e=~~Number(t);let n=t.replace(/^./g,"0");t<3&&(n=t);const r={2.75:"+","0.0":"a",.17:"a+",.33:"b",.5:"b+",.67:"c",.83:"c+"};return`${e}${r[n]?r[n]:""}`}(t.grade))).attr("text-anchor","middle");const d=k().scaleExtent([.1,2.5]).on("zoom",((t,e)=>{o.select(".zoom").attr("transform",t.transform),s.attr("transform",`scale(${1/t.transform.k})`)})),f=i/l.height*.9,u=a/2-l.width/2*f,p=i/2-l.height/2*f;o.call(d).call(d.transform,z.translate(u,p).scale(f)),o.select(".zoom").attr("transform",`translate(${u}, ${p}) scale(${f})`),j("g.map-region").on("click",(function(t){t.stopPropagation();const e=o.select(`#${this.id}`).node().getBBox(),n=i/e.height*.8,r=-(e.x-l.x)*n,s=-(e.y-l.y)*n,c=i/2-e.height/2*n,f=a/2-e.width/2*n;o.transition().duration(500).call(d.transform,z.translate(r+f,s+c).scale(n))}))}return _((async()=>{let t,e;var r,s;n(2,[t,e,o]=await Promise.all([fetch((s=8,`${I}/gyms/${s}/climbs?json_params=${encodeURIComponent(JSON.stringify({filters:{deleted:!1,live:!0}}))}`)),fetch(H(8)),fetch((r="bruut_boulder_breda",`https://cdn1.toplogger.nu/images/gyms/${r}/floorplan.svg`))]).then((t=>Promise.all([t[0].json(),t[1].json(),t[2].text()]))).then((t=>(n(2,o=t[2]),t))).catch((t=>{throw new Error(t)})),o),l(t,e)})),t.$$.update=()=>{t.$$.dirty,t.$$.dirty},[a,i,o,r,function(){n(1,i=J.innerHeight),n(0,a=J.innerWidth)}]}new class extends e{constructor(t){super(),n(this,t,A,B,r,{})}}({target:document.body,props:{}});
